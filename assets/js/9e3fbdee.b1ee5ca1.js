"use strict";(globalThis.webpackChunkdocs_locki_io=globalThis.webpackChunkdocs_locki_io||[]).push([[974],{8453(e,t,n){n.d(t,{R:()=>o,x:()=>i});var r=n(6540);const s={},a=r.createContext(s);function o(e){const t=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(a.Provider,{value:t},e.children)}},9815(e,t,n){n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>r,toc:()=>u});const r=JSON.parse('{"id":"app/core/features","title":"features","description":"Implement the Feature Class","source":"@site/docs/app/core/features.md","sourceDirName":"app/core","slug":"/app/core/features","permalink":"/docs/app/core/features","draft":false,"unlisted":false,"editUrl":"https://github.com/locki-io/docs.locki.io/tree/main/docs/app/core/features.md","tags":[],"version":"current","frontMatter":{}}');var s=n(4848),a=n(8453);const o={},i=void 0,l={},u=[{value:"Implement the Feature Class",id:"implement-the-feature-class",level:2},{value:"feature registry",id:"feature-registry",level:2},{value:"<strong>Export from features module</strong> (<code>app/agents/forseti/features/__init__.py</code>):",id:"export-from-features-module-appagentsforsetifeatures__init__py",level:2},{value:"<strong>Register in agent</strong> (<code>app/agents/forseti/agent.py</code>):",id:"register-in-agent-appagentsforsetiagentpy",level:2},{value:"Write Tests",id:"write-tests",level:2}];function p(e){const t={code:"code",h2:"h2",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"implement-the-feature-class",children:"Implement the Feature Class"}),"\n",(0,s.jsxs)(t.p,{children:["Create ",(0,s.jsx)(t.code,{children:"app/agents/forseti/features/my_feature.py"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'"""\nMy Feature\n\nDescription of what this feature does.\n"""\n\nfrom app.providers import LLMProvider\n\nfrom ..models import MyFeatureResult\nfrom ..prompts import MY_FEATURE_PROMPT\nfrom .base import FeatureBase\n\n\nclass MyFeatureFeature(FeatureBase):\n    """\n    Feature for [description].\n    """\n\n    @property\n    def name(self) -> str:\n        return "my_feature"\n\n    @property\n    def prompt(self) -> str:\n        return MY_FEATURE_PROMPT\n\n    async def execute(\n        self,\n        provider: LLMProvider,\n        system_prompt: str,\n        title: str,\n        body: str,\n        **kwargs,\n    ) -> MyFeatureResult:\n        """\n        Execute the feature.\n\n        Args:\n            provider: LLM provider.\n            system_prompt: Agent persona prompt.\n            title: Contribution title.\n            body: Contribution body.\n\n        Returns:\n            MyFeatureResult with results.\n        """\n        user_prompt = self.format_prompt(title=title, body=body)\n\n        try:\n            data = await self._get_json_response(\n                provider=provider,\n                system_prompt=system_prompt,\n                user_prompt=user_prompt,\n                temperature=0.3,\n            )\n\n            return MyFeatureResult(\n                field1=data.get("field1", ""),\n                field2=data.get("field2", []),\n                reasoning=data.get("reasoning", ""),\n                confidence=float(data.get("confidence", 0.5)),\n            )\n        except Exception as e:\n            return MyFeatureResult(\n                field1="",\n                field2=[],\n                reasoning=f"Error: {e}",\n                confidence=0.5,\n            )\n'})}),"\n",(0,s.jsx)(t.h2,{id:"feature-registry",children:"feature registry"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'class ForsetiAgent(BaseAgent):\n    def __init__(self):\n        super().__init__()\n        self.register_feature(CharterValidationFeature())\n        self.register_feature(CategoryClassificationFeature())\n\n        if enable_wording:\n            self.register_feature(WordingCorrectionFeature())\n\n    # Execute specific feature\n    result = await agent.execute_feature("charter_validation", title="...", body="...")\n\n    # Execute all features\n    results = await agent.execute_all(title="...", body="...")\n'})}),"\n",(0,s.jsxs)(t.h2,{id:"export-from-features-module-appagentsforsetifeatures__init__py",children:[(0,s.jsx)(t.strong,{children:"Export from features module"})," (",(0,s.jsx)(t.code,{children:"app/agents/forseti/features/__init__.py"}),"):"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'from .my_feature import MyFeatureFeature\n\n__all__ = [\n    # ... existing ...\n    "MyFeatureFeature",\n]\n'})}),"\n",(0,s.jsxs)(t.h2,{id:"register-in-agent-appagentsforsetiagentpy",children:[(0,s.jsx)(t.strong,{children:"Register in agent"})," (",(0,s.jsx)(t.code,{children:"app/agents/forseti/agent.py"}),"):"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'from .features import MyFeatureFeature\n\nclass ForsetiAgent(BaseAgent):\n    def __init__(self, ..., enable_my_feature: bool = False):\n        # ...\n        if enable_my_feature:\n            self.register_feature(MyFeatureFeature())\n\n    async def my_feature(self, title: str, body: str) -> MyFeatureResult:\n        """Public method for the feature."""\n        return await self.execute_feature("my_feature", title=title, body=body)\n'})}),"\n",(0,s.jsx)(t.h2,{id:"write-tests",children:"Write Tests"}),"\n",(0,s.jsxs)(t.p,{children:["Create ",(0,s.jsx)(t.code,{children:"tests/test_my_feature.py"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'import pytest\nfrom unittest.mock import AsyncMock, patch\n\nfrom app.agents.forseti import ForsetiAgent\nfrom app.agents.forseti.models import MyFeatureResult\n\n\n@pytest.fixture\ndef mock_provider():\n    provider = AsyncMock()\n    provider.complete.return_value = AsyncMock(\n        content=\'{"field1": "test", "field2": [], "reasoning": "ok", "confidence": 0.9}\'\n    )\n    return provider\n\n\n@pytest.mark.asyncio\nasync def test_my_feature(mock_provider):\n    agent = ForsetiAgent(provider=mock_provider, enable_my_feature=True)\n    result = await agent.my_feature(title="Test", body="Content")\n\n    assert isinstance(result, MyFeatureResult)\n    assert result.field1 == "test"\n'})})]})}function c(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}}}]);