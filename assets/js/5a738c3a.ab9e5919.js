"use strict";(globalThis.webpackChunkdocs_locki_io=globalThis.webpackChunkdocs_locki_io||[]).push([[9316],{2226(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"app/ANONYMIZATION","title":"Document Anonymization Pipeline","description":"The anonymization pipeline provides PII protection for documents processed through the field input workflow. It auto-detects document type and routes to the appropriate anonymizer.","source":"@site/docs/app/ANONYMIZATION.md","sourceDirName":"app","slug":"/app/ANONYMIZATION","permalink":"/docs/app/ANONYMIZATION","draft":false,"unlisted":false,"editUrl":"https://github.com/locki-io/docs.locki.io/tree/main/docs/app/ANONYMIZATION.md","tags":[],"version":"current","frontMatter":{},"sidebar":"appSidebar","previous":{"title":"Mockup System - Contribution Testing Framework","permalink":"/docs/app/MOCKUP"},"next":{"title":"Prompt Management Architecture","permalink":"/docs/app/core/prompts"}}');var s=i(4848),r=i(8453);const d={},l="Document Anonymization Pipeline",c={},o=[{value:"Pipeline Integration",id:"pipeline-integration",level:2},{value:"Usage",id:"usage",level:3},{value:"Configuration",id:"configuration",level:3},{value:"Result Fields",id:"result-fields",level:3},{value:"Frontend Integration",id:"frontend-integration",level:2},{value:"Files",id:"files",level:2},{value:"Pre-Release Test Report",id:"pre-release-test-report",level:2},{value:"Test Results",id:"test-results",level:3},{value:"Known Issues",id:"known-issues",level:3},{value:"Verification Checklist",id:"verification-checklist",level:3}];function a(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",input:"input",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"document-anonymization-pipeline",children:"Document Anonymization Pipeline"})}),"\n",(0,s.jsx)(n.p,{children:"The anonymization pipeline provides PII protection for documents processed through the field input workflow. It auto-detects document type and routes to the appropriate anonymizer."}),"\n",(0,s.jsxs)(n.p,{children:["For feature details (modes, entity types, Opik PII guardrail), see ",(0,s.jsx)(n.a,{href:"/docs/agents/forseti/features_details#feature-4-anonymization",children:"Forseti Anonymization Feature"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["For the cost/accuracy/speed analysis, see the ",(0,s.jsx)(n.a,{href:"/blog/anonymization-trilemma",children:"Anonymization Trilemma"})," blog post."]}),"\n",(0,s.jsx)(n.h2,{id:"pipeline-integration",children:"Pipeline Integration"}),"\n",(0,s.jsx)(n.p,{children:"Anonymization runs automatically before theme extraction in the field input pipeline:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Input Text\n    \u2502\n    \u25bc\n[Document Type Detection] (instant, regex-based)\n    \u251c\u2500\u2500 Transcript with names? \u2192 Regex Anonymizer (free, instant)\n    \u251c\u2500\u2500 Already anonymous? \u2192 Skip\n    \u2514\u2500\u2500 General document? \u2192 LLM Anonymizer (accurate, costly)\n    \u2502\n    \u25bc\n[PII Validation] \u2190 Opik Guardrail (NLP check)\n    \u2502\n    \u25bc\n[Theme Extraction] \u2192 Uses anonymized text\n"})}),"\n",(0,s.jsx)(n.h3,{id:"usage",children:"Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'from app.mockup.field_input import FieldInputGenerator, AnonymizationConfig\n\ngen = FieldInputGenerator(provider="gemini")\nresult = await gen.process_field_input(\n    input_text=text,\n    anonymization_config=AnonymizationConfig(enabled=True, mode="auto")\n)\n'})}),"\n",(0,s.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'@dataclass\nclass AnonymizationConfig:\n    enabled: bool = True\n    mode: Literal["auto", "transcript", "llm", "none"] = "auto"\n    similarity_threshold: float = 0.85  # For fuzzy name matching\n    store_mapping: bool = True  # Store entity mappings in result\n'})}),"\n",(0,s.jsx)(n.h3,{id:"result-fields",children:"Result Fields"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"anonymization_applied"}),": bool"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"anonymization_type"}),': "transcript" | "llm" | None']}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"anonymization_mapping"}),": dict of original to anonymized"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"keywords_from_anonymization"}),": list (LLM mode only)"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"frontend-integration",children:"Frontend Integration"}),"\n",(0,s.jsx)(n.p,{children:"Three Forseti features available in the Contributions tab:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Button"}),(0,s.jsx)(n.th,{children:"Feature"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Verify charter"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"validate"})}),(0,s.jsx)(n.td,{children:"Full charter validation"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Classify"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"classify_category"})}),(0,s.jsx)(n.td,{children:"Category classification"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Anonymize"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"anonymization"})}),(0,s.jsx)(n.td,{children:"PII anonymization"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"files",children:"Files"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"File"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"app/mockup/anonymizer.py"})}),(0,s.jsx)(n.td,{children:"Transcript anonymizer, type detection, PII validation"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"app/agents/forseti/features/anonymization.py"})}),(0,s.jsx)(n.td,{children:"LLM-based anonymization feature"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"app/mockup/field_input.py"})}),(0,s.jsx)(n.td,{children:"Pipeline integration"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"app/prompts/local/forseti.py"})}),(0,s.jsx)(n.td,{children:"Anonymization prompt template"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"pre-release-test-report",children:"Pre-Release Test Report"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Date:"})," 2026-02-08\n",(0,s.jsx)(n.strong,{children:"Branch:"})," ",(0,s.jsx)(n.code,{children:"feature/apscheduler-plan-tasks"}),"\n",(0,s.jsx)(n.strong,{children:"Status:"})," Ready for merge to dev"]}),"\n",(0,s.jsx)(n.h3,{id:"test-results",children:"Test Results"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Test"}),(0,s.jsx)(n.th,{children:"Status"}),(0,s.jsx)(n.th,{children:"Details"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Core imports"}),(0,s.jsx)(n.td,{children:"PASS"}),(0,s.jsx)(n.td,{children:"anonymizer, field_input, features, models"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Transcript detection"}),(0,s.jsx)(n.td,{children:"PASS"}),(0,s.jsx)(n.td,{children:"Correctly identifies TRANSCRIPT_NAMED"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"General doc detection"}),(0,s.jsx)(n.td,{children:"PASS"}),(0,s.jsx)(n.td,{children:"Correctly identifies GENERAL"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Transcript anonymization"}),(0,s.jsx)(n.td,{children:"PASS"}),(0,s.jsx)(n.td,{children:"2 speakers, names replaced"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Empty string handling"}),(0,s.jsx)(n.td,{children:"PASS"}),(0,s.jsx)(n.td,{children:"Returns GENERAL type, no crash"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Already anonymous detection"}),(0,s.jsx)(n.td,{children:"PASS"}),(0,s.jsx)(n.td,{children:"Detects TRANSCRIPT_ANONYMOUS"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Levenshtein dependency"}),(0,s.jsx)(n.td,{children:"PASS"}),(0,s.jsx)(n.td,{children:"Ratio 0.83 for Karine/Carine"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"AnonymizationConfig defaults"}),(0,s.jsx)(n.td,{children:"PASS"}),(0,s.jsx)(n.td,{children:"enabled=True, mode=auto"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"FieldInputResult serialization"}),(0,s.jsx)(n.td,{children:"PASS"}),(0,s.jsx)(n.td,{children:"to_dict() includes anonymization fields"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"PII validation"}),(0,s.jsx)(n.td,{children:"PASS"}),(0,s.jsx)(n.td,{children:"Returns result (graceful degradation)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Translation keys (EN)"}),(0,s.jsx)(n.td,{children:"PASS"}),(0,s.jsx)(n.td,{children:"All 9 new keys present"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Translation keys (FR)"}),(0,s.jsx)(n.td,{children:"PASS"}),(0,s.jsx)(n.td,{children:"All 9 new keys present"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"EN/FR key parity"}),(0,s.jsx)(n.td,{children:"PASS"}),(0,s.jsx)(n.td,{children:"No missing keys"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"front.py syntax"}),(0,s.jsx)(n.td,{children:"PASS"}),(0,s.jsx)(n.td,{children:"AST parse successful"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Required functions"}),(0,s.jsx)(n.td,{children:"PASS"}),(0,s.jsx)(n.td,{children:"All 7 functions defined"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Required imports"}),(0,s.jsx)(n.td,{children:"PASS"}),(0,s.jsx)(n.td,{children:"json, AnonymizationFeature"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Docs build"}),(0,s.jsx)(n.td,{children:"PASS"}),(0,s.jsx)(n.td,{children:"Successfully generated"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"known-issues",children:"Known Issues"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Issue"}),(0,s.jsx)(n.th,{children:"Severity"}),(0,s.jsx)(n.th,{children:"Mitigation"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Opik PII Guardrail API errors"}),(0,s.jsx)(n.td,{children:"Low"}),(0,s.jsx)(n.td,{children:"Fails open with error logged"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"N8N webhook empty response"}),(0,s.jsx)(n.td,{children:"Low"}),(0,s.jsx)(n.td,{children:"JSONDecodeError now caught"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Docs broken anchors (FR)"}),(0,s.jsx)(n.td,{children:"Low"}),(0,s.jsx)(n.td,{children:"Pre-existing, unrelated"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"verification-checklist",children:"Verification Checklist"}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","All imports resolve correctly"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Transcript anonymization works"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","LLM anonymization works"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Auto-detection routes correctly"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Error handling graceful"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Translations complete"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Frontend buttons functional"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Docs build successfully"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.em,{children:["Related: ",(0,s.jsx)(n.a,{href:"/docs/agents/forseti/ARCHITECTURE",children:"Forseti Agent"})," | ",(0,s.jsx)(n.a,{href:"/docs/app/FIELD_INPUT_WORKFLOW",children:"Field Input Workflow"})," | ",(0,s.jsx)(n.a,{href:"/docs/app/LOGGING",children:"Logging"})]})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},8453(e,n,i){i.d(n,{R:()=>d,x:()=>l});var t=i(6540);const s={},r=t.createContext(s);function d(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);