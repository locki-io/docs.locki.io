"use strict";(globalThis.webpackChunkdocs_locki_io=globalThis.webpackChunkdocs_locki_io||[]).push([[4320],{373(e,n,s){s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"orchestration/WORKFLOWS","title":"Workflow Best Practices","description":"Recommendations and patterns for creating effective n8n workflows in Vaettir.","source":"@site/docs/orchestration/WORKFLOWS.md","sourceDirName":"orchestration","slug":"/orchestration/WORKFLOWS","permalink":"/docs/orchestration/WORKFLOWS","draft":false,"unlisted":false,"editUrl":"https://github.com/locki-io/docs.locki.io/tree/main/docs/orchestration/WORKFLOWS.md","tags":[],"version":"current","frontMatter":{}}');var r=s(4848),l=s(8453);const t={},o="Workflow Best Practices",d={},c=[{value:"Workflow Design Principles",id:"workflow-design-principles",level:2},{value:"1. Keep Workflows Focused",id:"1-keep-workflows-focused",level:3},{value:"2. Error Handling",id:"2-error-handling",level:3},{value:"3. Use Descriptive Names",id:"3-use-descriptive-names",level:3},{value:"Common Patterns",id:"common-patterns",level:2},{value:"Pattern 1: API Integration with Retry",id:"pattern-1-api-integration-with-retry",level:3},{value:"Pattern 2: Data Transformation Pipeline",id:"pattern-2-data-transformation-pipeline",level:3},{value:"Pattern 3: Scheduled Tasks",id:"pattern-3-scheduled-tasks",level:3},{value:"Pattern 4: Webhook Handler",id:"pattern-4-webhook-handler",level:3},{value:"Pattern 5: Multi-Service Orchestration",id:"pattern-5-multi-service-orchestration",level:3},{value:"Code Node Best Practices",id:"code-node-best-practices",level:2},{value:"Python Code Nodes",id:"python-code-nodes",level:3},{value:"JavaScript Code Nodes",id:"javascript-code-nodes",level:3},{value:"Data Flow Best Practices",id:"data-flow-best-practices",level:2},{value:"1. Use Set Node for Data Shaping",id:"1-use-set-node-for-data-shaping",level:3},{value:"2. Filter Early",id:"2-filter-early",level:3},{value:"3. Merge Carefully",id:"3-merge-carefully",level:3},{value:"Performance Optimization",id:"performance-optimization",level:2},{value:"1. Batch Operations",id:"1-batch-operations",level:3},{value:"2. Parallel Execution",id:"2-parallel-execution",level:3},{value:"3. Cache Results",id:"3-cache-results",level:3},{value:"4. Limit Execution Time",id:"4-limit-execution-time",level:3},{value:"Security Best Practices",id:"security-best-practices",level:2},{value:"1. Use Credentials",id:"1-use-credentials",level:3},{value:"2. Validate Webhook Signatures",id:"2-validate-webhook-signatures",level:3},{value:"3. Sanitize User Input",id:"3-sanitize-user-input",level:3},{value:"4. Use HTTPS",id:"4-use-https",level:3},{value:"Testing Workflows",id:"testing-workflows",level:2},{value:"Manual Testing",id:"manual-testing",level:3},{value:"Production Testing",id:"production-testing",level:3},{value:"Debug Techniques",id:"debug-techniques",level:3},{value:"Workflow Organization",id:"workflow-organization",level:2},{value:"Naming Convention",id:"naming-convention",level:3},{value:"Tagging",id:"tagging",level:3},{value:"Documentation",id:"documentation",level:3},{value:"Version Control",id:"version-control",level:3},{value:"Common Pitfalls",id:"common-pitfalls",level:2},{value:"1. Not Handling Errors",id:"1-not-handling-errors",level:3},{value:"2. Infinite Loops",id:"2-infinite-loops",level:3},{value:"3. Memory Issues",id:"3-memory-issues",level:3},{value:"4. Rate Limiting",id:"4-rate-limiting",level:3},{value:"5. Timezone Confusion",id:"5-timezone-confusion",level:3},{value:"Advanced Patterns",id:"advanced-patterns",level:2},{value:"Sub-Workflows",id:"sub-workflows",level:3},{value:"State Machines",id:"state-machines",level:3},{value:"Event-Driven Architecture",id:"event-driven-architecture",level:3},{value:"Resources",id:"resources",level:2},{value:"Next Steps",id:"next-steps",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"workflow-best-practices",children:"Workflow Best Practices"})}),"\n",(0,r.jsx)(n.p,{children:"Recommendations and patterns for creating effective n8n workflows in Vaettir."}),"\n",(0,r.jsx)(n.h2,{id:"workflow-design-principles",children:"Workflow Design Principles"}),"\n",(0,r.jsx)(n.h3,{id:"1-keep-workflows-focused",children:"1. Keep Workflows Focused"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Good"}),": Single-purpose workflows"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'Workflow: "Process GitHub Webhook"\n- Receives webhook\n- Validates signature\n- Updates database\n- Sends notification\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Avoid"}),": Kitchen-sink workflows"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'Workflow: "Handle Everything"\n- GitHub webhooks\n- Facebook posts\n- Email processing\n- Data cleanup\n- ...50 different things\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Why"}),": Easier to debug, test, and maintain."]}),"\n",(0,r.jsx)(n.h3,{id:"2-error-handling",children:"2. Error Handling"}),"\n",(0,r.jsx)(n.p,{children:"Always add error handling paths:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[Trigger] \u2192 [Main Logic] \u2192 [Success Handler]\n                \u2193 (on error)\n           [Error Handler] \u2192 [Alert Admin]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"In n8n"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Click on node"}),"\n",(0,r.jsx)(n.li,{children:'Settings \u2192 "Continue On Fail"'}),"\n",(0,r.jsx)(n.li,{children:"Add error handling nodes"}),"\n",(0,r.jsx)(n.li,{children:'Use "Error Trigger" node to catch errors'}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"3-use-descriptive-names",children:"3. Use Descriptive Names"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Good names"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"GitHub: Validate Webhook Signature"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"DB: Insert New Contribution"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"Email: Send Welcome Message"})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Bad names"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"HTTP Request"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"Code"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"Function 1"})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Why"}),": You (and others) need to understand workflows at a glance."]}),"\n",(0,r.jsx)(n.h2,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,r.jsx)(n.h3,{id:"pattern-1-api-integration-with-retry",children:"Pattern 1: API Integration with Retry"}),"\n",(0,r.jsx)(n.p,{children:"For calling external APIs reliably:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[Trigger]\n   \u2193\n[Validate Input]\n   \u2193\n[HTTP Request] \u2190 Retry: 3 times, Exponential backoff\n   \u2193 (success)\n[Process Response]\n   \u2193\n[Store Result]\n   \u2193 (error)\n[Log Error] \u2192 [Notify Admin]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Configuration"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"HTTP Request node: Settings \u2192 Retry: 3"}),"\n",(0,r.jsx)(n.li,{children:"Continue on fail: true"}),"\n",(0,r.jsx)(n.li,{children:"Error workflow: Create separate error handler"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"pattern-2-data-transformation-pipeline",children:"Pattern 2: Data Transformation Pipeline"}),"\n",(0,r.jsx)(n.p,{children:"Processing data through multiple steps:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[Webhook]\n   \u2193\n[Code: Validate Schema]\n   \u2193\n[Code: Transform Data]\n   \u2193\n[Split in Batches] \u2190 Process 10 items at a time\n   \u2193\n[For Each Item]\n   \u2193\n[HTTP: Call API]\n   \u2193\n[Merge Results]\n   \u2193\n[Store to Database]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Why batching"}),": Prevents overwhelming external APIs or database."]}),"\n",(0,r.jsx)(n.h3,{id:"pattern-3-scheduled-tasks",children:"Pattern 3: Scheduled Tasks"}),"\n",(0,r.jsx)(n.p,{children:"Background jobs that run periodically:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[Schedule: Every Hour]\n   \u2193\n[DB: Fetch Pending Items]\n   \u2193\n[If: Items Exist?] \u2500No\u2192 [Stop]\n   \u2193 Yes\n[For Each Item]\n   \u2193\n[Process Item]\n   \u2193\n[DB: Mark Complete]\n   \u2193\n[Cleanup Old Data]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best practices"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:'Use "Cron" trigger for precise scheduling'}),"\n",(0,r.jsx)(n.li,{children:'Add "If" nodes to skip when no work needed'}),"\n",(0,r.jsx)(n.li,{children:"Clean up old data to prevent database bloat"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"pattern-4-webhook-handler",children:"Pattern 4: Webhook Handler"}),"\n",(0,r.jsx)(n.p,{children:"Receiving and processing webhooks:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[Webhook: POST /webhook/github]\n   \u2193\n[Code: Verify Signature]\n   \u2193 (invalid)\n[Return: 401 Unauthorized]\n   \u2193 (valid)\n[Code: Parse Payload]\n   \u2193\n[Switch: Event Type]\n   \u251c\u2500\u2192 push \u2192 [Handle Push]\n   \u251c\u2500\u2192 pr \u2192 [Handle PR]\n   \u2514\u2500\u2192 issue \u2192 [Handle Issue]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Security"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Always verify webhook signatures"}),"\n",(0,r.jsx)(n.li,{children:"Validate payload structure"}),"\n",(0,r.jsx)(n.li,{children:"Rate limit if possible"}),"\n",(0,r.jsx)(n.li,{children:"Return quickly (process async if needed)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"pattern-5-multi-service-orchestration",children:"Pattern 5: Multi-Service Orchestration"}),"\n",(0,r.jsx)(n.p,{children:"Coordinating multiple services (via proxy pattern):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[Trigger]\n   \u2193\n[HTTP: ocapistaine] \u2190 Calls http://ocapistaine:8000\n   \u2193\n[Code: Process Result]\n   \u2193\n[HTTP: another-service] \u2190 Calls http://another-service:3000\n   \u2193\n[Combine Results]\n   \u2193\n[Store & Notify]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Benefits"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Services are interchangeable (dev vs prod)"}),"\n",(0,r.jsx)(n.li,{children:"Easy to test with local instances"}),"\n",(0,r.jsx)(n.li,{children:"Clean separation of concerns"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"code-node-best-practices",children:"Code Node Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"python-code-nodes",children:"Python Code Nodes"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Structure your code"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Import at top\nimport json\nimport re\nfrom datetime import datetime\n\n# Get input data\nitems = $input.all()\n\n# Process\nresults = []\nfor item in items:\n    data = item.json\n\n    # Your logic here\n    processed = {\n        'original': data,\n        'timestamp': datetime.utcnow().isoformat(),\n        'processed': True\n    }\n\n    results.append({'json': processed})\n\n# Return\nreturn results\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Tips"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Always return list of dicts with ",(0,r.jsx)(n.code,{children:"json"})," key"]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"$input.all()"})," for all items or ",(0,r.jsx)(n.code,{children:"$input.first()"})," for single"]}),"\n",(0,r.jsxs)(n.li,{children:["Available modules defined in ",(0,r.jsx)(n.code,{children:"n8n-task-runners.json"})]}),"\n",(0,r.jsx)(n.li,{children:"Test code locally before putting in n8n"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"javascript-code-nodes",children:"JavaScript Code Nodes"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Get all input items\nconst items = $input.all();\n\n// Process\nconst results = items.map((item) => {\n  const data = item.json;\n\n  // Your logic\n  return {\n    json: {\n      original: data,\n      timestamp: new Date().toISOString(),\n      processed: true,\n    },\n  };\n});\n\n// Return\nreturn results;\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Tips"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Modern JS (ES6+) supported"}),"\n",(0,r.jsx)(n.li,{children:"No external npm packages by default (configure in task-runners.json)"}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"console.log()"})," for debugging"]}),"\n",(0,r.jsxs)(n.li,{children:["Access environment vars via ",(0,r.jsx)(n.code,{children:"$env"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"data-flow-best-practices",children:"Data Flow Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"1-use-set-node-for-data-shaping",children:"1. Use Set Node for Data Shaping"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Instead of Code node"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[HTTP Request]\n   \u2193\n[Code: Extract fields] \u2190 Avoid if possible\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Set node"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[HTTP Request]\n   \u2193\n[Set] \u2190 Configure fields in UI\n  - user.name \u2192 name\n  - user.email \u2192 email\n  - created_at \u2192 timestamp\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Why"}),": Easier to maintain, no coding needed."]}),"\n",(0,r.jsx)(n.h3,{id:"2-filter-early",children:"2. Filter Early"}),"\n",(0,r.jsx)(n.p,{children:"Process only what you need:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[Fetch 1000 items]\n   \u2193\n[Filter: status = 'pending'] \u2190 Reduce to 50 items\n   \u2193\n[Expensive Operation] \u2190 Only runs 50 times\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-merge-carefully",children:"3. Merge Carefully"}),"\n",(0,r.jsx)(n.p,{children:"When combining data from multiple sources:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[Source A]    [Source B]\n   \u2193              \u2193\n   \u2514\u2500\u2500[Merge]\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2193\n    [Use merged data]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Merge options"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Append"}),": Combine all items"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Keep Matches"}),": Inner join"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Keep Non-Matches"}),": Left/right join"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Choose based on your needs."}),"\n",(0,r.jsx)(n.h2,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,r.jsx)(n.h3,{id:"1-batch-operations",children:"1. Batch Operations"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Slow"})," (1000 database calls):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[For Each of 1000 Items]\n   \u2193\n[DB: Insert One]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Fast"})," (10 database calls):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[Split in Batches: 100]\n   \u2193\n[DB: Bulk Insert 100]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-parallel-execution",children:"2. Parallel Execution"}),"\n",(0,r.jsx)(n.p,{children:"For independent operations:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[Trigger]\n   \u251c\u2500\u2192 [Task A] \u2500\u2510\n   \u251c\u2500\u2192 [Task B] \u2500\u2524\n   \u2514\u2500\u2192 [Task C] \u2500\u2534\u2192 [Merge & Continue]\n"})}),"\n",(0,r.jsx)(n.p,{children:'Enable: Node settings \u2192 "Execute Once" (not "Run Once For Each Item")'}),"\n",(0,r.jsx)(n.h3,{id:"3-cache-results",children:"3. Cache Results"}),"\n",(0,r.jsx)(n.p,{children:"For expensive operations that don't change often:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[Check Cache]\n   \u2193 (miss)\n[Expensive API Call]\n   \u2193\n[Store in Cache]\n   \u2193\n[Return Result]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Implementation"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use n8n database nodes"}),"\n",(0,r.jsx)(n.li,{children:"Set TTL (time to live)"}),"\n",(0,r.jsx)(n.li,{children:"Clear cache when data updates"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"4-limit-execution-time",children:"4. Limit Execution Time"}),"\n",(0,r.jsx)(n.p,{children:"Add timeouts to prevent hanging:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[HTTP Request]\n  Timeout: 30 seconds\n  Retry: 3 times\n  Retry Wait: 5 seconds (exponential)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"security-best-practices",children:"Security Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"1-use-credentials",children:"1. Use Credentials"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Never hardcode"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'// BAD!\nconst apiKey = "sk-1234567890abcdef";\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use n8n credentials"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Settings \u2192 Credentials \u2192 Add"}),"\n",(0,r.jsx)(n.li,{children:'Create "API Key" credential'}),"\n",(0,r.jsxs)(n.li,{children:["Reference in nodes: ",(0,r.jsx)(n.code,{children:"{{ $credentials.myApiKey }}"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"2-validate-webhook-signatures",children:"2. Validate Webhook Signatures"}),"\n",(0,r.jsx)(n.p,{children:"For GitHub webhooks:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import hmac\nimport hashlib\n\ndef verify_signature(payload, signature, secret):\n    expected = 'sha256=' + hmac.new(\n        secret.encode(),\n        payload.encode(),\n        hashlib.sha256\n    ).hexdigest()\n\n    return hmac.compare_digest(expected, signature)\n\n# In workflow\nsignature = $input.first().headers['x-hub-signature-256']\nis_valid = verify_signature(payload, signature, secret)\n\nif not is_valid:\n    raise Exception('Invalid signature')\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-sanitize-user-input",children:"3. Sanitize User Input"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Always validate and sanitize"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import re\n\ndef sanitize_input(user_input):\n    # Remove special characters\n    cleaned = re.sub(r'[^\\w\\s-]', '', user_input)\n    # Limit length\n    return cleaned[:100]\n\n# Use in workflow\nsafe_input = sanitize_input(user_provided_data)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"4-use-https",children:"4. Use HTTPS"}),"\n",(0,r.jsx)(n.p,{children:"All external HTTP calls should use HTTPS:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"URL: https://api.example.com  \u2713\nURL: http://api.example.com   \u2717\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Exception: Internal services (",(0,r.jsx)(n.a,{href:"http://ocapistaine:8000",children:"http://ocapistaine:8000"})," is fine)"]}),"\n",(0,r.jsx)(n.h2,{id:"testing-workflows",children:"Testing Workflows"}),"\n",(0,r.jsx)(n.h3,{id:"manual-testing",children:"Manual Testing"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use Test Webhook"}),": Create temporary webhook for testing"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Execute Manually"}),': Click "Execute Workflow" button']}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Check Each Node"}),": View input/output data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use Sample Data"}),": Create test trigger data"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"production-testing",children:"Production Testing"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Start with disabled"}),": Create workflow, keep inactive"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Test in isolation"}),": Use separate test account/environment"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Monitor closely"}),": Watch first few executions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Enable gradually"}),": Start with low traffic, increase slowly"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"debug-techniques",children:"Debug Techniques"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"View data between nodes"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Click on connector line between nodes"}),"\n",(0,r.jsx)(n.li,{children:"See data flowing through"}),"\n",(0,r.jsx)(n.li,{children:"Identify transformation issues"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Stop nodes"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[Process A]\n   \u2193\n[Stop] \u2190 Temporarily stops here for inspection\n   \u2193\n[Process B]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Add logging"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'// In Code node\nconsole.log("Processing item:", item);\nconsole.log("Result:", result);\n'})}),"\n",(0,r.jsxs)(n.p,{children:["View logs: ",(0,r.jsx)(n.code,{children:'docker compose logs n8n | grep "Processing"'})]}),"\n",(0,r.jsx)(n.h2,{id:"workflow-organization",children:"Workflow Organization"}),"\n",(0,r.jsx)(n.h3,{id:"naming-convention",children:"Naming Convention"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"<Category>: <Action> - <Details>\n\nExamples:\n- GitHub: Process Push Events - Main Repo\n- Email: Send Weekly Digest - Subscribers\n- DB: Cleanup Old Records - Monthly\n- API: Fetch User Data - Sync\n"})}),"\n",(0,r.jsx)(n.h3,{id:"tagging",children:"Tagging"}),"\n",(0,r.jsx)(n.p,{children:"Use tags for organization:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"production"})," - Live workflows"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"test"})," - Testing workflows"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"archived"})," - Old/unused"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"critical"})," - High-priority workflows"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"scheduled"})," - Cron/timer triggers"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"documentation",children:"Documentation"}),"\n",(0,r.jsx)(n.p,{children:"Add notes to workflows:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Click workflow canvas"}),"\n",(0,r.jsxs)(n.li,{children:["Add sticky notes with:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Purpose"}),"\n",(0,r.jsx)(n.li,{children:"Trigger conditions"}),"\n",(0,r.jsx)(n.li,{children:"Dependencies"}),"\n",(0,r.jsx)(n.li,{children:"Contact person"}),"\n",(0,r.jsx)(n.li,{children:"Last updated"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"version-control",children:"Version Control"}),"\n",(0,r.jsx)(n.p,{children:"n8n has built-in version history:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Every save creates a version"}),"\n",(0,r.jsx)(n.li,{children:"View: Workflow \u2192 Versions"}),"\n",(0,r.jsx)(n.li,{children:"Restore previous versions if needed"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Also backup workflows"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Export all workflows (via n8n API or UI)\n# Store in git repository\n"})}),"\n",(0,r.jsx)(n.h2,{id:"common-pitfalls",children:"Common Pitfalls"}),"\n",(0,r.jsx)(n.h3,{id:"1-not-handling-errors",children:"1. Not Handling Errors"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem"}),": Workflow fails silently\n",(0,r.jsx)(n.strong,{children:"Solution"}),": Add error handlers to all critical nodes"]}),"\n",(0,r.jsx)(n.h3,{id:"2-infinite-loops",children:"2. Infinite Loops"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem"}),": Workflow triggers itself\n",(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Add loop detection"}),"\n",(0,r.jsx)(n.li,{children:'Use "Workflow Already Running" check'}),"\n",(0,r.jsx)(n.li,{children:"Limit iterations"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"3-memory-issues",children:"3. Memory Issues"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem"}),": Processing too much data at once\n",(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:'Use "Split in Batches" node'}),"\n",(0,r.jsx)(n.li,{children:"Limit query results"}),"\n",(0,r.jsx)(n.li,{children:"Stream large files"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"4-rate-limiting",children:"4. Rate Limiting"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem"}),": API blocks your requests\n",(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Add delays between requests"}),"\n",(0,r.jsx)(n.li,{children:"Batch operations"}),"\n",(0,r.jsx)(n.li,{children:"Implement backoff strategy"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"5-timezone-confusion",children:"5. Timezone Confusion"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem"}),": Scheduled workflows run at wrong time\n",(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.code,{children:"GENERIC_TIMEZONE=Europe/Paris"})," in .env"]}),"\n",(0,r.jsx)(n.li,{children:"Use UTC internally, convert for display"}),"\n",(0,r.jsx)(n.li,{children:"Test schedule triggers carefully"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"advanced-patterns",children:"Advanced Patterns"}),"\n",(0,r.jsx)(n.h3,{id:"sub-workflows",children:"Sub-Workflows"}),"\n",(0,r.jsx)(n.p,{children:"Break complex logic into reusable pieces:"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Main Workflow"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[Trigger]\n   \u2193\n[Execute Workflow: Process User]\n   \u2193\n[Execute Workflow: Send Notification]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Sub-Workflow: Process User"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[Receive Input]\n   \u2193\n[Validate]\n   \u2193\n[Transform]\n   \u2193\n[Return Result]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"state-machines",children:"State Machines"}),"\n",(0,r.jsx)(n.p,{children:"For complex multi-step processes:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[Check Current State]\n   \u2193\n[Switch: State]\n   \u251c\u2500\u2192 new \u2192 [Process New] \u2192 [Set State: processing]\n   \u251c\u2500\u2192 processing \u2192 [Process Active] \u2192 [Set State: complete]\n   \u2514\u2500\u2192 complete \u2192 [Cleanup] \u2192 [Set State: archived]\n"})}),"\n",(0,r.jsx)(n.p,{children:"Store state in database, update as workflow progresses."}),"\n",(0,r.jsx)(n.h3,{id:"event-driven-architecture",children:"Event-Driven Architecture"}),"\n",(0,r.jsx)(n.p,{children:"Multiple workflows communicating:"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Workflow A"}),": Publishes event"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'[Action Happens]\n   \u2193\n[HTTP: POST /webhook/event]\n   Body: { "type": "user.created", "data": {...} }\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Workflow B"}),": Subscribes to event"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[Webhook: /webhook/event]\n   \u2193\n[Filter: type = 'user.created']\n   \u2193\n[Handle User Created]\n"})}),"\n",(0,r.jsx)(n.h2,{id:"resources",children:"Resources"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"n8n Workflow Templates"}),": ",(0,r.jsx)(n.a,{href:"https://n8n.io/workflows",children:"https://n8n.io/workflows"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"n8n Community Forum"}),": ",(0,r.jsx)(n.a,{href:"https://community.n8n.io",children:"https://community.n8n.io"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Expression Reference"}),": ",(0,r.jsx)(n.a,{href:"https://docs.n8n.io/code/expressions/",children:"https://docs.n8n.io/code/expressions/"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ocapistaine Knowledge Base"}),": ",(0,r.jsx)(n.a,{href:"https://docs.locki.io/",children:"The locki docusaurus"})," - Methods, agents, and workflows for content moderation"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/orchestration/DEVELOPMENT",children:"Development Workflow"})," - Test locally with proxy pattern"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/orchestration/TROUBLESHOOTING",children:"Troubleshooting"})," - Debug workflow issues"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/orchestration/ARCHITECTURE",children:"Architecture"})," - Understand the system"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453(e,n,s){s.d(n,{R:()=>t,x:()=>o});var i=s(6540);const r={},l=i.createContext(r);function t(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);