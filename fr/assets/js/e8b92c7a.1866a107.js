"use strict";(globalThis.webpackChunkdocs_locki_io=globalThis.webpackChunkdocs_locki_io||[]).push([[8718],{2982(e,r,i){i.r(r),i.d(r,{assets:()=>d,contentTitle:()=>t,default:()=>h,frontMatter:()=>c,metadata:()=>n,toc:()=>a});const n=JSON.parse('{"id":"workflows/firecrawl","title":"Firecrawl Workflow","description":"Web scraping workflow for municipal documents","source":"@site/docs/workflows/firecrawl.md","sourceDirName":"workflows","slug":"/workflows/firecrawl","permalink":"/fr/docs/workflows/firecrawl","draft":false,"unlisted":false,"editUrl":"https://github.com/locki-io/docs.locki.io/tree/main/docs/workflows/firecrawl.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"id":"firecrawl","title":"Firecrawl Workflow","sidebar_label":"Firecrawl","sidebar_position":3,"description":"Web scraping workflow for municipal documents"},"sidebar":"workflowsSidebar","previous":{"title":"Contribution Charter","permalink":"/fr/docs/workflows/contribution-charter"},"next":{"title":"n8n-integration","permalink":"/fr/docs/workflows/n8n-github-integration"}}');var l=i(4848),s=i(8453);const c={id:"firecrawl",title:"Firecrawl Workflow",sidebar_label:"Firecrawl",sidebar_position:3,description:"Web scraping workflow for municipal documents"},t="Firecrawl Workflow",d={},a=[{value:"Overview",id:"overview",level:2},{value:"Architecture",id:"architecture",level:2},{value:"Data Sources",id:"data-sources",level:2},{value:"Usage",id:"usage",level:2},{value:"Quick Start",id:"quick-start",level:3},{value:"Scrape Single Page (Testing)",id:"scrape-single-page-testing",level:3},{value:"Crawl Full Site (Production)",id:"crawl-full-site-production",level:3},{value:"Command-Line Options",id:"command-line-options",level:2},{value:"Output Structure",id:"output-structure",level:2},{value:"Recommended Workflow",id:"recommended-workflow",level:2},{value:"Phase 1: Exploration",id:"phase-1-exploration",level:3},{value:"Phase 2: Limited Crawl",id:"phase-2-limited-crawl",level:3},{value:"Phase 3: Full Crawl",id:"phase-3-full-crawl",level:3},{value:"Phase 4: OCR Processing",id:"phase-4-ocr-processing",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Rate Limiting",id:"rate-limiting",level:3},{value:"Empty Files",id:"empty-files",level:3},{value:"Integration with Opik",id:"integration-with-opik",level:2}];function o(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.header,{children:(0,l.jsx)(r.h1,{id:"firecrawl-workflow",children:"Firecrawl Workflow"})}),"\n",(0,l.jsx)(r.h2,{id:"overview",children:"Overview"}),"\n",(0,l.jsx)(r.p,{children:"The Firecrawl workflow collects and processes municipal documents from the Audierne website for the RAG knowledge base."}),"\n",(0,l.jsx)(r.h2,{id:"architecture",children:"Architecture"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"src/\n\u251c\u2500\u2500 config.py                    # Data source configuration\n\u251c\u2500\u2500 firecrawl_utils.py          # Firecrawl manager and utilities\n\u2514\u2500\u2500 crawl_municipal_docs.py     # Main orchestration script\n\next_data/\n\u251c\u2500\u2500 mairie_arretes/             # Output: arr\xeat\xe9s & publications\n\u251c\u2500\u2500 mairie_deliberations/       # Output: d\xe9lib\xe9rations\n\u2514\u2500\u2500 commission_controle/        # Output: commission documents\n"})}),"\n",(0,l.jsx)(r.h2,{id:"data-sources",children:"Data Sources"}),"\n",(0,l.jsxs)(r.table,{children:[(0,l.jsx)(r.thead,{children:(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.th,{children:"Source"}),(0,l.jsx)(r.th,{children:"URL"}),(0,l.jsx)(r.th,{children:"Method"}),(0,l.jsx)(r.th,{children:"Expected Count"})]})}),(0,l.jsxs)(r.tbody,{children:[(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"mairie_arretes"})}),(0,l.jsx)(r.td,{children:"audierne.bzh/publications-arretes/"}),(0,l.jsx)(r.td,{children:"firecrawl+ocr"}),(0,l.jsx)(r.td,{children:"~4010"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"mairie_deliberations"})}),(0,l.jsx)(r.td,{children:"audierne.bzh/deliberations-conseil-municipal/"}),(0,l.jsx)(r.td,{children:"firecrawl+ocr"}),(0,l.jsx)(r.td,{children:"-"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"commission_controle"})}),(0,l.jsx)(r.td,{children:"audierne.bzh/systeme/documentheque/?documents_category=49"}),(0,l.jsx)(r.td,{children:"firecrawl+ocr"}),(0,l.jsx)(r.td,{children:"-"})]})]})]}),"\n",(0,l.jsx)(r.h2,{id:"usage",children:"Usage"}),"\n",(0,l.jsx)(r.h3,{id:"quick-start",children:"Quick Start"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-bash",children:'# Set API key\nexport FIRECRAWL_API_KEY="your_key_here"\n\n# Install dependencies\npoetry install\n\n# Dry run\npoetry run python src/crawl_municipal_docs.py --dry-run\n'})}),"\n",(0,l.jsx)(r.h3,{id:"scrape-single-page-testing",children:"Scrape Single Page (Testing)"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-bash",children:"poetry run python src/crawl_municipal_docs.py --source mairie_arretes --mode scrape\n"})}),"\n",(0,l.jsx)(r.h3,{id:"crawl-full-site-production",children:"Crawl Full Site (Production)"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-bash",children:"poetry run python src/crawl_municipal_docs.py --source mairie_arretes --mode crawl --max-pages 500\n"})}),"\n",(0,l.jsx)(r.h2,{id:"command-line-options",children:"Command-Line Options"}),"\n",(0,l.jsxs)(r.table,{children:[(0,l.jsx)(r.thead,{children:(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.th,{children:"Option"}),(0,l.jsx)(r.th,{children:"Description"}),(0,l.jsx)(r.th,{children:"Default"})]})}),(0,l.jsxs)(r.tbody,{children:[(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"--source"})}),(0,l.jsx)(r.td,{children:"Which source to process"}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"all"})})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"--mode"})}),(0,l.jsxs)(r.td,{children:[(0,l.jsx)(r.code,{children:"scrape"})," (single page) or ",(0,l.jsx)(r.code,{children:"crawl"})," (full site)"]}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"scrape"})})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"--max-pages"})}),(0,l.jsx)(r.td,{children:"Maximum pages to crawl"}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"100"})})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"--api-key"})}),(0,l.jsx)(r.td,{children:"Firecrawl API key"}),(0,l.jsx)(r.td,{children:"env var"})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"--dry-run"})}),(0,l.jsx)(r.td,{children:"Preview without crawling"}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"false"})})]})]})]}),"\n",(0,l.jsx)(r.h2,{id:"output-structure",children:"Output Structure"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{children:"ext_data/<source_name>/\n\u251c\u2500\u2500 <page1>.md                    # Markdown content\n\u251c\u2500\u2500 <page1>.html                  # HTML content\n\u251c\u2500\u2500 <page1>_metadata.json         # Full metadata\n\u251c\u2500\u2500 index_<timestamp>.md          # Index of all pages\n\u251c\u2500\u2500 crawl_metadata_<timestamp>.json\n\u2514\u2500\u2500 errors.log                    # Error log (if any)\n"})}),"\n",(0,l.jsx)(r.h2,{id:"recommended-workflow",children:"Recommended Workflow"}),"\n",(0,l.jsx)(r.h3,{id:"phase-1-exploration",children:"Phase 1: Exploration"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-bash",children:"# Test each source structure\npoetry run python src/crawl_municipal_docs.py --source mairie_arretes --mode scrape\n"})}),"\n",(0,l.jsx)(r.h3,{id:"phase-2-limited-crawl",children:"Phase 2: Limited Crawl"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-bash",children:"# Validate with small sample\npoetry run python src/crawl_municipal_docs.py --source mairie_arretes --mode crawl --max-pages 10\n"})}),"\n",(0,l.jsx)(r.h3,{id:"phase-3-full-crawl",children:"Phase 3: Full Crawl"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-bash",children:"# Production crawl\npoetry run python src/crawl_municipal_docs.py --source mairie_arretes --mode crawl --max-pages 500\n"})}),"\n",(0,l.jsx)(r.h3,{id:"phase-4-ocr-processing",children:"Phase 4: OCR Processing"}),"\n",(0,l.jsx)(r.p,{children:"After Firecrawl completes, process downloaded PDFs:"}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsx)(r.li,{children:"Apply OCR (language: French)"}),"\n",(0,l.jsx)(r.li,{children:"Extract text from scanned documents"}),"\n",(0,l.jsx)(r.li,{children:"Feed into RAG system"}),"\n"]}),"\n",(0,l.jsx)(r.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,l.jsx)(r.h3,{id:"rate-limiting",children:"Rate Limiting"}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsx)(r.li,{children:"Wait a few minutes between large crawls"}),"\n",(0,l.jsxs)(r.li,{children:["Reduce ",(0,l.jsx)(r.code,{children:"--max-pages"})]}),"\n",(0,l.jsx)(r.li,{children:"Process sources one at a time"}),"\n"]}),"\n",(0,l.jsx)(r.h3,{id:"empty-files",children:"Empty Files"}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsxs)(r.li,{children:["Check ",(0,l.jsx)(r.code,{children:"errors.log"})," in output directory"]}),"\n",(0,l.jsxs)(r.li,{children:["Try ",(0,l.jsx)(r.code,{children:"--mode scrape"})," first to test structure"]}),"\n",(0,l.jsx)(r.li,{children:"Verify URL is accessible"}),"\n"]}),"\n",(0,l.jsx)(r.h2,{id:"integration-with-opik",children:"Integration with Opik"}),"\n",(0,l.jsx)(r.p,{children:"All crawl operations are traced via Opik for observability:"}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsx)(r.li,{children:"Track crawl duration and success rates"}),"\n",(0,l.jsx)(r.li,{children:"Monitor API usage and costs"}),"\n",(0,l.jsx)(r.li,{children:"Identify problematic pages"}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,l.jsx)(r,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},8453(e,r,i){i.d(r,{R:()=>c,x:()=>t});var n=i(6540);const l={},s=n.createContext(l);function c(e){const r=n.useContext(s);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function t(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:c(e.components),n.createElement(s.Provider,{value:r},e.children)}}}]);