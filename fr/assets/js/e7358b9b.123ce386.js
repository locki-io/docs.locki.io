"use strict";(globalThis.webpackChunkdocs_locki_io=globalThis.webpackChunkdocs_locki_io||[]).push([[2784],{2952(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"app/AUTO_CONTRIBUTIONS","title":"Auto-Contribution Workflow","description":"Overview","source":"@site/docs/app/AUTO_CONTRIBUTIONS.md","sourceDirName":"app","slug":"/app/AUTO_CONTRIBUTIONS","permalink":"/fr/docs/app/AUTO_CONTRIBUTIONS","draft":false,"unlisted":false,"editUrl":"https://github.com/locki-io/docs.locki.io/tree/main/docs/app/AUTO_CONTRIBUTIONS.md","tags":[],"version":"current","frontMatter":{},"sidebar":"appSidebar","previous":{"title":"Forseti 461 Agent","permalink":"/fr/docs/app/FORSETI_AGENT"},"next":{"title":"Mockup System - Contribution Testing Framework","permalink":"/fr/docs/app/MOCKUP"}}');var i=t(4848),r=t(8453);const o={},d="Auto-Contribution Workflow",c={},l=[{value:"Overview",id:"overview",level:2},{value:"Architecture",id:"architecture",level:2},{value:"Workflow Steps",id:"workflow-steps",level:2},{value:"Key Classes",id:"key-classes",level:2},{value:"Integration Points",id:"integration-points",level:2},{value:"TODO: Complete Refactoring",id:"todo-complete-refactoring",level:2},{value:"Tests (Priority)",id:"tests-priority",level:3},{value:"Documentation",id:"documentation",level:3},{value:"Cleanup",id:"cleanup",level:3},{value:"Current Status",id:"current-status",level:2},{value:"Separation of Concerns (SoC)",id:"separation-of-concerns-soc",level:2},{value:"Function Inventory",id:"function-inventory",level:3},{value:"Design Principles",id:"design-principles",level:3},{value:"Usage",id:"usage",level:2},{value:"Streamlit URL",id:"streamlit-url",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"auto-contribution-workflow",children:"Auto-Contribution Workflow"})}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"The Auto-Contribution system guides citizens through creating charter-compliant contributions via a 5-step workflow with Forseti 461 validation."}),"\n",(0,i.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"app/processors/workflows/workflow_autocontribution.py  \u2190 Business Logic\napp/auto_contribution/views.py                         \u2190 Streamlit UI\napp/auto_contribution/__init__.py                      \u2190 Module exports\n"})}),"\n",(0,i.jsx)(n.h2,{id:"workflow-steps",children:"Workflow Steps"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Step"}),(0,i.jsx)(n.th,{children:"Function"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"step_1_load_sources()"})}),(0,i.jsx)(n.td,{children:"Load Audierne2026 docs or accept pasted text"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"step_2_select_category()"})}),(0,i.jsx)(n.td,{children:"Return 7 charter categories"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"step_3_generate_draft()"})}),(0,i.jsx)(n.td,{children:"LLM generates constat_factuel + idees_ameliorations"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"4"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"step_4_edit_contribution()"})}),(0,i.jsx)(n.td,{children:"User edits draft (UI handles this)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"5"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"step_5_validate_and_save()"})}),(0,i.jsx)(n.td,{children:"Forseti validates \u2192 Redis storage"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"key-classes",children:"Key Classes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"AutoContributionWorkflow"})," - Orchestrates the workflow programmatically"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"AutoContributionConfig"})," - Provider/model/language settings"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"AutoContributionResult"})," - Validation results + contribution ID"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"DraftContribution"})," - Generated draft content"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ContributionAssistant"})," - LLM wrapper for draft generation"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"integration-points",children:"Integration Points"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Mockup Tab"}),": Loads contributions from Redis first (fallback: JSON)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Forseti 461"}),": Pre-save validation with full result storage"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Redis Storage"}),": ",(0,i.jsx)(n.code,{children:'source="input"'})," distinguishes from mockup data"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Bilingual"}),": FR/EN translations with ",(0,i.jsx)(n.code,{children:"autocontrib_*"})," keys"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Prompt Registry"}),": Uses ",(0,i.jsx)(n.code,{children:"app/prompts/"})," for centralized prompt management (see ",(0,i.jsx)(n.a,{href:"/fr/docs/app/PROMPT_MANAGEMENT",children:"PROMPT_MANAGEMENT.md"}),")"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"todo-complete-refactoring",children:"TODO: Complete Refactoring"}),"\n",(0,i.jsx)(n.h3,{id:"tests-priority",children:"Tests (Priority)"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Update ",(0,i.jsx)(n.code,{children:"tests/test_contribution_assistant.py"})," imports to use workflow"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Update ",(0,i.jsx)(n.code,{children:"tests/test_questions_integration.py"})," \u2192 ",(0,i.jsx)(n.code,{children:"test_autocontribution_integration.py"})]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Run ",(0,i.jsx)(n.code,{children:"poetry run pytest tests/ -v"})," (17 tests passing)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"documentation",children:"Documentation"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ",'Update MOCKUP.md references from "Questions Tab" to "Auto-Contribution Tab"']}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Delete PLAN_QUESTIONS_TAB.md (no longer needed)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"cleanup",children:"Cleanup"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Remove old ",(0,i.jsx)(n.code,{children:"app/questions/"})," references if any remain"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Verify all ",(0,i.jsx)(n.code,{children:"questions_*"})," translation keys are renamed to ",(0,i.jsx)(n.code,{children:"autocontrib_*"})]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Test the Streamlit UI at ",(0,i.jsx)(n.code,{children:"?tab=autocontrib"})," (user confirmed working)"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"current-status",children:"Current Status"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"All tasks completed \u2705"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u2705 Created ",(0,i.jsx)(n.code,{children:"app/processors/workflows/"})," directory"]}),"\n",(0,i.jsxs)(n.li,{children:["\u2705 Created ",(0,i.jsx)(n.code,{children:"workflow_autocontribution.py"})," with all 5 step functions"]}),"\n",(0,i.jsxs)(n.li,{children:["\u2705 Renamed ",(0,i.jsx)(n.code,{children:"app/questions/"})," \u2192 ",(0,i.jsx)(n.code,{children:"app/auto_contribution/"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u2705 Updated ",(0,i.jsx)(n.code,{children:"views.py"})," to use workflow functions"]}),"\n",(0,i.jsxs)(n.li,{children:["\u2705 Updated ",(0,i.jsx)(n.code,{children:"front.py"})," import and tab config"]}),"\n",(0,i.jsxs)(n.li,{children:["\u2705 Updated FR/EN translations (",(0,i.jsx)(n.code,{children:"autocontrib_*"})," keys)"]}),"\n",(0,i.jsxs)(n.li,{children:["\u2705 Updated ",(0,i.jsx)(n.code,{children:"processors/__init__.py"})," exports"]}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Updated tests to new import paths (17 tests passing)"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Updated MOCKUP.md documentation"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Manual testing of full workflow"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"separation-of-concerns-soc",children:"Separation of Concerns (SoC)"}),"\n",(0,i.jsxs)(n.p,{children:["The Auto-Contribution system follows a clear separation between ",(0,i.jsx)(n.strong,{children:"UI"}),", ",(0,i.jsx)(n.strong,{children:"Business Logic"}),", and ",(0,i.jsx)(n.strong,{children:"Shared Services"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         SEPARATION OF CONCERNS                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  UI LAYER (Presentation)                                             \u2502    \u2502\n\u2502  \u2502  app/auto_contribution/views.py                                      \u2502    \u2502\n\u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524    \u2502\n\u2502  \u2502  \u2022 autocontribution_view()        Main view entry point              \u2502    \u2502\n\u2502  \u2502  \u2022 _render_step_1_source()        Source selection UI                \u2502    \u2502\n\u2502  \u2502  \u2022 _render_step_2_category()      Category picker UI                 \u2502    \u2502\n\u2502  \u2502  \u2022 _render_step_3_inspiration()   Draft generation UI + spinner      \u2502    \u2502\n\u2502  \u2502  \u2022 _render_step_4_edit()          Editable text_area widgets         \u2502    \u2502\n\u2502  \u2502  \u2022 _render_step_5_confirmation()  Success + Forseti results display  \u2502    \u2502\n\u2502  \u2502  \u2022 _init_state() / _reset_state() Session state management           \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                    \u2502                                         \u2502\n\u2502                                    \u25bc                                         \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  BUSINESS LOGIC LAYER (Processing)                                   \u2502    \u2502\n\u2502  \u2502  app/processors/workflows/workflow_autocontribution.py               \u2502    \u2502\n\u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524    \u2502\n\u2502  \u2502  Step Functions (stateless, reusable):                               \u2502    \u2502\n\u2502  \u2502  \u2022 step_1_load_sources()          \u2192 List[Dict] of doc metadata       \u2502    \u2502\n\u2502  \u2502  \u2022 load_source_content()          \u2192 str document content             \u2502    \u2502\n\u2502  \u2502  \u2022 step_2_select_category()       \u2192 List[str] categories             \u2502    \u2502\n\u2502  \u2502  \u2022 get_category_description()     \u2192 str localized description        \u2502    \u2502\n\u2502  \u2502  \u2022 step_3_generate_draft()        \u2192 DraftContribution (sync)         \u2502    \u2502\n\u2502  \u2502  \u2022 step_4_edit_contribution()     \u2192 DraftContribution (edited)       \u2502    \u2502\n\u2502  \u2502  \u2022 step_5_validate_and_save()     \u2192 AutoContributionResult           \u2502    \u2502\n\u2502  \u2502  \u2022 run_forseti_validation()       \u2192 Dict validation results          \u2502    \u2502\n\u2502  \u2502                                                                       \u2502    \u2502\n\u2502  \u2502  Classes:                                                             \u2502    \u2502\n\u2502  \u2502  \u2022 ContributionAssistant          LLM wrapper for draft generation   \u2502    \u2502\n\u2502  \u2502  \u2022 AutoContributionWorkflow       Orchestrator for programmatic use  \u2502    \u2502\n\u2502  \u2502                                                                       \u2502    \u2502\n\u2502  \u2502  Data Classes:                                                        \u2502    \u2502\n\u2502  \u2502  \u2022 DraftContribution              constat + idees + category + title \u2502    \u2502\n\u2502  \u2502  \u2022 AutoContributionConfig         provider + model + language        \u2502    \u2502\n\u2502  \u2502  \u2022 AutoContributionResult         validation results + contrib_id    \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                    \u2502                                         \u2502\n\u2502                                    \u25bc                                         \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  SHARED SERVICES LAYER (Infrastructure)                              \u2502    \u2502\n\u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524    \u2502\n\u2502  \u2502  app/agents/forseti/                                                  \u2502    \u2502\n\u2502  \u2502  \u2022 ForsetiAgent.validate()        Charter validation                 \u2502    \u2502\n\u2502  \u2502  \u2022 CATEGORIES                     7 category constants               \u2502    \u2502\n\u2502  \u2502                                                                       \u2502    \u2502\n\u2502  \u2502  app/mockup/                                                          \u2502    \u2502\n\u2502  \u2502  \u2022 field_input.py                 list_audierne_docs(), read_md()    \u2502    \u2502\n\u2502  \u2502  \u2022 storage.py                     get_storage(), ValidationRecord    \u2502    \u2502\n\u2502  \u2502                                                                       \u2502    \u2502\n\u2502  \u2502  app/providers.py                                                     \u2502    \u2502\n\u2502  \u2502  \u2022 get_provider()                 LLM abstraction (Gemini/Claude)    \u2502    \u2502\n\u2502  \u2502                                                                       \u2502    \u2502\n\u2502  \u2502  app/i18n.py                                                          \u2502    \u2502\n\u2502  \u2502  \u2022 _(), get_language()            Translation functions              \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsx)(n.h3,{id:"function-inventory",children:"Function Inventory"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Layer"}),(0,i.jsx)(n.th,{children:"Function"}),(0,i.jsx)(n.th,{children:"Concern"}),(0,i.jsx)(n.th,{children:"Reusable"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"UI"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"autocontribution_view()"})}),(0,i.jsx)(n.td,{children:"Entry point, routing"}),(0,i.jsx)(n.td,{children:"No"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"UI"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"_render_step_*()"})}),(0,i.jsx)(n.td,{children:"Step-specific widgets"}),(0,i.jsx)(n.td,{children:"No"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"UI"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"_init_state()"})}),(0,i.jsx)(n.td,{children:"Session management"}),(0,i.jsx)(n.td,{children:"No"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Logic"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"step_1_load_sources()"})}),(0,i.jsx)(n.td,{children:"Document discovery"}),(0,i.jsx)(n.td,{children:"\u2705 Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Logic"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"load_source_content()"})}),(0,i.jsx)(n.td,{children:"File reading"}),(0,i.jsx)(n.td,{children:"\u2705 Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Logic"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"step_2_select_category()"})}),(0,i.jsx)(n.td,{children:"Category list"}),(0,i.jsx)(n.td,{children:"\u2705 Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Logic"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"get_category_description()"})}),(0,i.jsx)(n.td,{children:"i18n helper"}),(0,i.jsx)(n.td,{children:"\u2705 Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Logic"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"step_3_generate_draft()"})}),(0,i.jsx)(n.td,{children:"LLM draft (sync)"}),(0,i.jsx)(n.td,{children:"\u2705 Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Logic"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"step_4_edit_contribution()"})}),(0,i.jsx)(n.td,{children:"Merge edits"}),(0,i.jsx)(n.td,{children:"\u2705 Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Logic"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"step_5_validate_and_save()"})}),(0,i.jsx)(n.td,{children:"Forseti + Redis"}),(0,i.jsx)(n.td,{children:"\u2705 Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Logic"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"run_forseti_validation()"})}),(0,i.jsx)(n.td,{children:"Validation only"}),(0,i.jsx)(n.td,{children:"\u2705 Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Logic"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ContributionAssistant"})}),(0,i.jsx)(n.td,{children:"LLM prompts"}),(0,i.jsx)(n.td,{children:"\u2705 Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Logic"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"AutoContributionWorkflow"})}),(0,i.jsx)(n.td,{children:"Orchestrator"}),(0,i.jsx)(n.td,{children:"\u2705 Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Shared"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ForsetiAgent.validate()"})}),(0,i.jsx)(n.td,{children:"Charter rules"}),(0,i.jsx)(n.td,{children:"\u2705 Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Shared"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"list_audierne_docs()"})}),(0,i.jsx)(n.td,{children:"Doc listing"}),(0,i.jsx)(n.td,{children:"\u2705 Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Shared"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"get_storage()"})}),(0,i.jsx)(n.td,{children:"Redis access"}),(0,i.jsx)(n.td,{children:"\u2705 Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Shared"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"get_provider()"})}),(0,i.jsx)(n.td,{children:"LLM factory"}),(0,i.jsx)(n.td,{children:"\u2705 Yes"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"design-principles",children:"Design Principles"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"UI knows nothing about LLMs"})," - Views call workflow functions, not providers"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Business logic is stateless"})," - Step functions take inputs, return outputs"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Shared services are generic"})," - No workflow-specific code in agents/mockup"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Data flows downward"})," - UI \u2192 Logic \u2192 Services (no callbacks)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Testing is easy"})," - Mock at service boundaries (providers, storage)"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'from app.processors import AutoContributionWorkflow, AutoContributionConfig\n\n# Programmatic usage\nconfig = AutoContributionConfig(provider="gemini", language="fr")\nworkflow = AutoContributionWorkflow(config)\n\nsources = workflow.load_sources()\ncontent = workflow.load_source_content(sources[0]["path"])\ndraft = workflow.generate_draft(content, "economie")\nresult = workflow.validate_and_save(draft)\n\nprint(f"ID: {result.contribution_id}, Valid: {result.is_valid}")\n'})}),"\n",(0,i.jsx)(n.h2,{id:"streamlit-url",children:"Streamlit URL"}),"\n",(0,i.jsxs)(n.p,{children:["Access via: ",(0,i.jsx)(n.code,{children:"http://localhost:8502/?tab=autocontrib"})]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453(e,n,t){t.d(n,{R:()=>o,x:()=>d});var s=t(6540);const i={},r=s.createContext(i);function o(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);