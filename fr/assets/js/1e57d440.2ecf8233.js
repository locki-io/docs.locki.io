"use strict";(globalThis.webpackChunkdocs_locki_io=globalThis.webpackChunkdocs_locki_io||[]).push([[5537],{3665(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>t,toc:()=>a});var t=i(7691),r=i(4848),s=i(8453);const d={slug:"anonymization-trilemma",title:"The Anonymization Trilemma: Balancing Cost, Accuracy, and Speed in Civic AI",authors:["jnxmas"],tags:["ai-ml","privacy","civictech","pii","anonymization"],description:"Three complementary approaches to document anonymization\u2014and how auto-detection picks the right one for each document type"},l="The Anonymization Trilemma: Balancing Cost, Accuracy, and Speed in Civic AI",c={authorsImageUrls:[void 0]},a=[{value:"The Problem: PII in Civic Data",id:"the-problem-pii-in-civic-data",level:2},{value:"The Trilemma",id:"the-trilemma",level:2},{value:"Our Solution: Three-Mode Architecture",id:"our-solution-three-mode-architecture",level:2},{value:"Mode 1: Transcript Regex (Free, Instant)",id:"mode-1-transcript-regex-free-instant",level:3},{value:"Mode 2: LLM-Based (Accurate, Costly)",id:"mode-2-llm-based-accurate-costly",level:3},{value:"Mode 3: NLP Guardrail (Validation)",id:"mode-3-nlp-guardrail-validation",level:3},{value:"Auto-Detection Logic",id:"auto-detection-logic",level:2},{value:"The Economics",id:"the-economics",level:2},{value:"Scenario: Processing 100 municipal documents",id:"scenario-processing-100-municipal-documents",level:3},{value:"Integration with Field Input Pipeline",id:"integration-with-field-input-pipeline",level:2},{value:"Privacy vs Utility Tradeoff",id:"privacy-vs-utility-tradeoff",level:2},{value:"Lessons Learned",id:"lessons-learned",level:2},{value:"1. Structure Is Free",id:"1-structure-is-free",level:3},{value:"2. Context Costs Money",id:"2-context-costs-money",level:3},{value:"3. Validation Is Cheap Insurance",id:"3-validation-is-cheap-insurance",level:3},{value:"4. Keywords Are Side Benefits",id:"4-keywords-are-side-benefits",level:3},{value:"The Trilemma, Resolved",id:"the-trilemma-resolved",level:2}];function o(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A hybrid approach that uses regex for transcripts, LLMs for general documents, and NLP guardrails for validation"})}),"\n",(0,r.jsx)(n.h2,{id:"the-problem-pii-in-civic-data",children:"The Problem: PII in Civic Data"}),"\n",(0,r.jsx)(n.p,{children:"Municipal transcripts, citizen contributions, and public hearing records contain sensitive personal information:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Names"}),': "Florent Lardic proposed that..."']}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Contact info"}),": Emails, phone numbers shared during Q&A"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Addresses"}),': "I live at 12 rue de la Paix and..."']}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Before processing these documents through our AI pipeline for theme extraction, we need to anonymize them. But how?"}),"\n",(0,r.jsx)(n.h2,{id:"the-trilemma",children:"The Trilemma"}),"\n",(0,r.jsx)(n.p,{children:"Every anonymization approach forces a tradeoff:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"           ACCURACY\n              \u25b2\n              \u2502\n              \u2502    \u2605 LLM-based\n              \u2502    (understands context)\n              \u2502\n              \u2502         \u2605 NLP Guardrails\n              \u2502         (good entity detection)\n              \u2502\n              \u2502              \u2605 Regex\n              \u2502              (pattern matching only)\n              \u2502\n    \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6 SPEED\n              \u2502\n         COST \u2502\n              \u25bc\n"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Approach"}),(0,r.jsx)(n.th,{children:"Cost"}),(0,r.jsx)(n.th,{children:"Accuracy"}),(0,r.jsx)(n.th,{children:"Speed"}),(0,r.jsx)(n.th,{children:"Best For"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Regex"})}),(0,r.jsx)(n.td,{children:"Free"}),(0,r.jsx)(n.td,{children:"Medium"}),(0,r.jsx)(n.td,{children:"Instant"}),(0,r.jsx)(n.td,{children:"Structured formats (transcripts)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"LLM"})}),(0,r.jsx)(n.td,{children:"$$$"}),(0,r.jsx)(n.td,{children:"High"}),(0,r.jsx)(n.td,{children:"Slow"}),(0,r.jsx)(n.td,{children:"Complex context, general docs"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"NLP"})}),(0,r.jsx)(n.td,{children:"Free"}),(0,r.jsx)(n.td,{children:"Medium-High"}),(0,r.jsx)(n.td,{children:"Fast"}),(0,r.jsx)(n.td,{children:"Validation, pre-screening"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"You can't optimize all three."})," But you can pick the right approach for each document type."]}),"\n",(0,r.jsx)(n.h2,{id:"our-solution-three-mode-architecture",children:"Our Solution: Three-Mode Architecture"}),"\n",(0,r.jsx)(n.p,{children:"We implemented a hybrid system that auto-detects document type and routes to the appropriate anonymizer:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Input Text\n    \u2193\n[Document Type Detection]\n    \u251c\u2500\u2500 Transcript with names? \u2192 Regex Anonymizer (free, instant)\n    \u251c\u2500\u2500 Already anonymous? \u2192 Skip (no processing needed)\n    \u2514\u2500\u2500 General document? \u2192 LLM Anonymizer (accurate, costly)\n    \u2193\n[PII Validation] \u2190 Opik Guardrail (NLP check)\n    \u2193\n[Theme Extraction] \u2192 Uses anonymized text\n"})}),"\n",(0,r.jsx)(n.h3,{id:"mode-1-transcript-regex-free-instant",children:"Mode 1: Transcript Regex (Free, Instant)"}),"\n",(0,r.jsx)(n.p,{children:"Municipal meeting transcripts follow a predictable format:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"00:00:00 Florent Lardic\nnous allons discuter du programme...\n\n00:05:23 Malika Redaouia\nje pense que nous devrions...\n"})}),"\n",(0,r.jsx)(n.p,{children:"A regex pattern extracts speakers and replaces them consistently:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# Pattern: HH:MM:SS followed by speaker name\nTIMESTAMP_PATTERN = re.compile(\n    r"^(\\d{2}:\\d{2}:\\d{2})\\s+(.+?)$", re.MULTILINE\n)\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Result:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"00:00:00 Speaker_1\nnous allons discuter du programme...\n\n00:05:23 Speaker_2\nje pense que nous devrions...\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Features:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Consistent mapping"}),": Same name = same Speaker_N throughout"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Fuzzy matching"}),': Handles "Karine" vs "Carine" variations (Levenshtein distance)']}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Inline replacement"}),': "comme Florent le disait" \u2192 "comme Speaker_1 le disait"']}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Benchmarks (90k character transcript):"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Metric"}),(0,r.jsx)(n.th,{children:"Value"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Processing time"}),(0,r.jsx)(n.td,{children:"12ms"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"API cost"}),(0,r.jsx)(n.td,{children:"$0.00"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Speakers detected"}),(0,r.jsx)(n.td,{children:"7"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Replacements made"}),(0,r.jsx)(n.td,{children:"199"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Accuracy"}),(0,r.jsx)(n.td,{children:"High for structured transcripts"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"mode-2-llm-based-accurate-costly",children:"Mode 2: LLM-Based (Accurate, Costly)"}),"\n",(0,r.jsx)(n.p,{children:"General documents need context understanding:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Jean Dupont habite au 12 rue de la Paix \xe0 Audierne.\nSon email est jean.dupont@example.com.\nLa Mairie devrait am\xe9liorer...\n"})}),"\n",(0,r.jsx)(n.p,{children:"An LLM understands that:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:'"Jean Dupont" is a person \u2192 anonymize'}),"\n",(0,r.jsx)(n.li,{children:'"12 rue de la Paix" is an address \u2192 anonymize'}),"\n",(0,r.jsxs)(n.li,{children:['"Audierne" is a public place \u2192 ',(0,r.jsx)(n.strong,{children:"keep as keyword"})]}),"\n",(0,r.jsxs)(n.li,{children:['"La Mairie" is an institution \u2192 ',(0,r.jsx)(n.strong,{children:"keep as keyword"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Result:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "anonymized_text": "[PERSONNE_1] habite au [ADRESSE_1] \xe0 Audierne...",\n  "entity_mapping": {\n    "Jean Dupont": "[PERSONNE_1]",\n    "12 rue de la Paix": "[ADRESSE_1]",\n    "jean.dupont@example.com": "[EMAIL_1]"\n  },\n  "keywords_extracted": ["Audierne", "Mairie"]\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"The key insight"}),": Organizations and places aren't PII\u2014they're valuable keywords for theme extraction. The LLM distinguishes between what to hide and what to keep."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Benchmarks (1k character document):"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Metric"}),(0,r.jsx)(n.th,{children:"Value"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Processing time"}),(0,r.jsx)(n.td,{children:"2-5 seconds"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"API cost"}),(0,r.jsx)(n.td,{children:"~$0.001-0.003"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Accuracy"}),(0,r.jsx)(n.td,{children:"High (context-aware)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Keywords extracted"}),(0,r.jsx)(n.td,{children:"Yes"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"mode-3-nlp-guardrail-validation",children:"Mode 3: NLP Guardrail (Validation)"}),"\n",(0,r.jsx)(n.p,{children:"Opik's PII guardrail uses traditional NER (Named Entity Recognition) to detect remaining PII:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from app.mockup.anonymizer import validate_no_pii\n\nresult = validate_no_pii("Speaker_1 a dit que la mairie doit agir.")\n# result.is_clean = True\n\nresult = validate_no_pii("Jean Dupont a dit que la mairie doit agir.")\n# result.is_clean = False (PERSON detected)\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use cases:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pre-LLM check"}),": Quick validation before expensive LLM calls"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Post-processing audit"}),": Verify no PII leaked through"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Logging"}),": Track PII detection failures in Opik dashboard"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Benchmarks:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Metric"}),(0,r.jsx)(n.th,{children:"Value"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Processing time"}),(0,r.jsx)(n.td,{children:"50-100ms"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"API cost"}),(0,r.jsx)(n.td,{children:"$0.00 (local NLP)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Accuracy"}),(0,r.jsx)(n.td,{children:"Medium-High"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Entity types"}),(0,r.jsx)(n.td,{children:"PERSON, EMAIL, PHONE, CREDIT_CARD, etc."})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"auto-detection-logic",children:"Auto-Detection Logic"}),"\n",(0,r.jsx)(n.p,{children:"The system automatically picks the right mode:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'def detect_document_type(text: str) -> DocumentType:\n    matches = TIMESTAMP_PATTERN.finditer(text)\n\n    if len(matches) < 3:\n        return DocumentType.GENERAL  # \u2192 LLM mode\n\n    # Check if speakers are already anonymous\n    sample_speakers = [m.group(2) for m in matches[:10]]\n    anonymous_count = sum(\n        1 for s in sample_speakers\n        if ANONYMOUS_PATTERN.match(s)  # "Speaker 1", "Intervenant 2"\n    )\n\n    if anonymous_count > len(sample_speakers) * 0.7:\n        return DocumentType.TRANSCRIPT_ANONYMOUS  # \u2192 Skip\n\n    return DocumentType.TRANSCRIPT_NAMED  # \u2192 Regex mode\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Detection accuracy"}),": 100% on our test corpus (transcripts have clear timestamp patterns)."]}),"\n",(0,r.jsx)(n.h2,{id:"the-economics",children:"The Economics"}),"\n",(0,r.jsx)(n.h3,{id:"scenario-processing-100-municipal-documents",children:"Scenario: Processing 100 municipal documents"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Doc Type"}),(0,r.jsx)(n.th,{children:"Count"}),(0,r.jsx)(n.th,{children:"Mode"}),(0,r.jsx)(n.th,{children:"Time"}),(0,r.jsx)(n.th,{children:"Cost"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Meeting transcripts"}),(0,r.jsx)(n.td,{children:"30"}),(0,r.jsx)(n.td,{children:"Regex"}),(0,r.jsx)(n.td,{children:"0.4s total"}),(0,r.jsx)(n.td,{children:"$0.00"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Already anonymous"}),(0,r.jsx)(n.td,{children:"10"}),(0,r.jsx)(n.td,{children:"Skip"}),(0,r.jsx)(n.td,{children:"0s"}),(0,r.jsx)(n.td,{children:"$0.00"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Citizen letters"}),(0,r.jsx)(n.td,{children:"40"}),(0,r.jsx)(n.td,{children:"LLM"}),(0,r.jsx)(n.td,{children:"160s (2.6min)"}),(0,r.jsx)(n.td,{children:"$0.12"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Short comments"}),(0,r.jsx)(n.td,{children:"20"}),(0,r.jsx)(n.td,{children:"LLM"}),(0,r.jsx)(n.td,{children:"60s"}),(0,r.jsx)(n.td,{children:"$0.04"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Total"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"100"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Mixed"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"~3.5min"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"$0.16"})})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Compare to LLM-only approach:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Mode"}),(0,r.jsx)(n.th,{children:"Time"}),(0,r.jsx)(n.th,{children:"Cost"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"LLM for all"}),(0,r.jsx)(n.td,{children:"~8 minutes"}),(0,r.jsx)(n.td,{children:"$0.30"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Auto-detect"}),(0,r.jsx)(n.td,{children:"~3.5 minutes"}),(0,r.jsx)(n.td,{children:"$0.16"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Savings"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"56%"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"47%"})})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"integration-with-field-input-pipeline",children:"Integration with Field Input Pipeline"}),"\n",(0,r.jsx)(n.p,{children:"The anonymization happens automatically before theme extraction:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from app.mockup.field_input import FieldInputGenerator, AnonymizationConfig\n\ngen = FieldInputGenerator(provider="gemini")\n\nresult = await gen.process_field_input(\n    input_text=transcript_text,\n    source_title="Conseil Municipal Janvier 2026",\n    anonymization_config=AnonymizationConfig(\n        enabled=True,\n        mode="auto",  # or "transcript", "llm", "none"\n    )\n)\n\nprint(f"Anonymization: {result.anonymization_type}")  # "transcript"\nprint(f"Speakers: {len(result.anonymization_mapping)}")  # 7\nprint(f"Keywords: {result.keywords_from_anonymization}")  # From LLM mode\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Result fields added:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"anonymization_applied"}),": bool"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"anonymization_type"}),': "transcript" | "llm" | None']}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"anonymization_mapping"}),": dict of original \u2192 anonymized"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"keywords_from_anonymization"}),": list (LLM mode only)"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"privacy-vs-utility-tradeoff",children:"Privacy vs Utility Tradeoff"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Priority"}),(0,r.jsx)(n.th,{children:"Configuration"}),(0,r.jsx)(n.th,{children:"Tradeoff"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Maximum privacy"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:'mode="llm"'})," always"]}),(0,r.jsx)(n.td,{children:"Higher cost, slower"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Maximum speed"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:'mode="transcript"'})," always"]}),(0,r.jsx)(n.td,{children:"May miss PII in general docs"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Balanced"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'mode="auto"'})}),(0,r.jsx)(n.td,{children:"Best cost/accuracy ratio"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Debugging"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'mode="none"'})}),(0,r.jsx)(n.td,{children:"No anonymization (dev only)"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["For production, ",(0,r.jsx)(n.strong,{children:"auto mode"})," is recommended: it gets transcript anonymization essentially free while only paying for LLM when truly needed."]}),"\n",(0,r.jsx)(n.h2,{id:"lessons-learned",children:"Lessons Learned"}),"\n",(0,r.jsx)(n.h3,{id:"1-structure-is-free",children:"1. Structure Is Free"}),"\n",(0,r.jsx)(n.p,{children:"Structured documents (transcripts, forms) can be anonymized with regex at zero cost. Invest in understanding your data formats before reaching for expensive solutions."}),"\n",(0,r.jsx)(n.h3,{id:"2-context-costs-money",children:"2. Context Costs Money"}),"\n",(0,r.jsx)(n.p,{children:'LLMs excel at understanding context ("Jean Dupont" is a person, "Dupont SA" is a company). But this understanding isn\'t free. Use it selectively.'}),"\n",(0,r.jsx)(n.h3,{id:"3-validation-is-cheap-insurance",children:"3. Validation Is Cheap Insurance"}),"\n",(0,r.jsx)(n.p,{children:"NLP-based PII detection (Opik guardrails) is fast and free. Running it after anonymization catches mistakes before they reach production."}),"\n",(0,r.jsx)(n.h3,{id:"4-keywords-are-side-benefits",children:"4. Keywords Are Side Benefits"}),"\n",(0,r.jsx)(n.p,{children:"LLM anonymization extracts useful keywords (organizations, places) as a side effect. These feed into theme extraction, improving downstream accuracy."}),"\n",(0,r.jsx)(n.h2,{id:"the-trilemma-resolved",children:"The Trilemma, Resolved"}),"\n",(0,r.jsxs)(n.p,{children:["You can't have the best of all three\u2014but you can have ",(0,r.jsx)(n.strong,{children:"the right tool for each job"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Document arrives\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Type Detection   \u2502 (instant, free)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n    \u250c\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502         \u2502              \u2502\n    \u25bc         \u25bc              \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Regex \u2502 \u2502 Skip  \u2502    \u2502   LLM    \u2502\n\u2502 (0ms) \u2502 \u2502 (0ms) \u2502    \u2502 (2-5s)   \u2502\n\u2502 ($0)  \u2502 \u2502 ($0)  \u2502    \u2502 ($0.003) \u2502\n\u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n    \u2502         \u2502              \u2502\n    \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 PII Validation   \u2502 (50ms, free)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n    Clean text for\n    theme extraction\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Result"}),": Fast where possible, accurate where necessary, validated always."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.em,{children:["Code reference: ",(0,r.jsx)(n.code,{children:"app/mockup/anonymizer.py"}),", ",(0,r.jsx)(n.code,{children:"app/mockup/field_input.py"}),", ",(0,r.jsx)(n.code,{children:"app/agents/forseti/features/anonymization.py"})]})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.em,{children:["Related: ",(0,r.jsx)(n.a,{href:"/blog/reliability-without-the-cloud-tax",children:"Reliability Without the Cloud Tax"})," | ",(0,r.jsx)(n.a,{href:"/blog/grounding-ai-in-reality",children:"Grounding AI in Reality"})]})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},7691(e){e.exports=JSON.parse('{"permalink":"/fr/blog/anonymization-trilemma","editUrl":"https://github.com/locki-io/docs.locki.io/tree/main/blog/2026-02-06-anonymization-trilemma.md","source":"@site/blog/2026-02-06-anonymization-trilemma.md","title":"The Anonymization Trilemma: Balancing Cost, Accuracy, and Speed in Civic AI","description":"Three complementary approaches to document anonymization\u2014and how auto-detection picks the right one for each document type","date":"2026-02-06T00:00:00.000Z","tags":[{"inline":false,"label":"AI and Machine Learning","permalink":"/fr/blog/tags/ai-ml","description":"Articles on AI, machine learning, and related technologies"},{"inline":false,"label":"Privacy","permalink":"/fr/blog/tags/privacy","description":"Articles on data privacy, PII protection, and anonymization"},{"inline":false,"label":"civitech","permalink":"/fr/blog/tags/civictech","description":"Citizen technologies and open source for the public good"},{"inline":false,"label":"PII Protection","permalink":"/fr/blog/tags/pii","description":"Articles on Personally Identifiable Information detection and handling"},{"inline":false,"label":"Anonymization","permalink":"/fr/blog/tags/anonymization","description":"Articles on document anonymization techniques and patterns"}],"readingTime":5.25,"hasTruncateMarker":true,"authors":[{"name":"Jean-No\xebl Schilling","title":"Locki one / french maintainer","url":"https://github.com/jnschilling","socials":{"linkedin":"https://www.linkedin.com/in/jnschilling/","github":"https://github.com/jnschilling","newsletter":"https://www.stratej.fr"},"imageURL":"https://github.com/jnschilling.png","key":"jnxmas","page":null}],"frontMatter":{"slug":"anonymization-trilemma","title":"The Anonymization Trilemma: Balancing Cost, Accuracy, and Speed in Civic AI","authors":["jnxmas"],"tags":["ai-ml","privacy","civictech","pii","anonymization"],"description":"Three complementary approaches to document anonymization\u2014and how auto-detection picks the right one for each document type"},"unlisted":false,"nextItem":{"title":"Reliability Without the Cloud Tax: Local LLMs with Intelligent Failover","permalink":"/fr/blog/reliability-without-the-cloud-tax"}}')},8453(e,n,i){i.d(n,{R:()=>d,x:()=>l});var t=i(6540);const r={},s=t.createContext(r);function d(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);