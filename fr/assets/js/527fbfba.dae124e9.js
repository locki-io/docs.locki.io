"use strict";(globalThis.webpackChunkdocs_locki_io=globalThis.webpackChunkdocs_locki_io||[]).push([[3778],{2287(e,n,s){s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"workflows/n8n-github-integration","title":"Integration of the N8N server to allow github actions","description":"n8n allows to integrate external services like github - email - discord","source":"@site/docs/workflows/n8n-github-integration.md","sourceDirName":"workflows","slug":"/workflows/n8n-github-integration","permalink":"/fr/docs/workflows/n8n-github-integration","draft":false,"unlisted":false,"editUrl":"https://github.com/locki-io/docs.locki.io/tree/main/docs/workflows/n8n-github-integration.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"id":"n8n-github-integration","title":"Integration of the N8N server to allow github actions","sidebar_label":"n8n-integration","sidebar_position":4,"description":"n8n allows to integrate external services like github - email - discord"},"sidebar":"workflowsSidebar","previous":{"title":"Firecrawl","permalink":"/fr/docs/workflows/firecrawl"}}');var t=s(4848),r=s(8453);const o={id:"n8n-github-integration",title:"Integration of the N8N server to allow github actions",sidebar_label:"n8n-integration",sidebar_position:4,description:"n8n allows to integrate external services like github - email - discord"},l="N8N GitHub Integration Workflows",a={},d=[{value:"Conventions",id:"conventions",level:2},{value:"Code Nodes: Python Only",id:"code-nodes-python-only",level:3},{value:"GitHub API Access",id:"github-api-access",level:3},{value:"Workflow Documentation",id:"workflow-documentation",level:3},{value:"Architecture Overview",id:"architecture-overview",level:2},{value:"Credential Setup in N8N",id:"credential-setup-in-n8n",level:2},{value:"GitHub Credential (to be created in N8N)",id:"github-credential-to-be-created-in-n8n",level:3},{value:"Forseti461 :",id:"forseti461-",level:3},{value:"OCapistaine API (internal network)",id:"ocapistaine-api-internal-network",level:3},{value:"Workflow 1: List Participons Issues",id:"workflow-1-list-participons-issues",level:2},{value:"Trigger",id:"trigger",level:3},{value:"Input Parameters",id:"input-parameters",level:3},{value:"Flow",id:"flow",level:3},{value:"HTTP Request Configuration",id:"http-request-configuration",level:3},{value:"Output Transformation (Python)",id:"output-transformation-python",level:3},{value:"Response Format",id:"response-format",level:3},{value:"Workflow 2: Get Issue Details",id:"workflow-2-get-issue-details",level:2},{value:"Trigger",id:"trigger-1",level:3},{value:"Input Parameters",id:"input-parameters-1",level:3},{value:"Flow",id:"flow-1",level:3},{value:"Response Format",id:"response-format-1",level:3},{value:"Workflow 3: Validate Issue (via OCapistaine)",id:"workflow-3-validate-issue-via-ocapistaine",level:2},{value:"Trigger",id:"trigger-2",level:3},{value:"Input Parameters",id:"input-parameters-2",level:3},{value:"Flow",id:"flow-2",level:3},{value:"HTTP Request to OCapistaine",id:"http-request-to-ocapistaine",level:3},{value:"Label Logic (Python)",id:"label-logic-python",level:3},{value:"Response Format",id:"response-format-2",level:3},{value:"Workflow 4: Batch Validate Issues",id:"workflow-4-batch-validate-issues",level:2},{value:"Trigger",id:"trigger-3",level:3},{value:"Input Parameters",id:"input-parameters-3",level:3},{value:"Flow",id:"flow-3",level:3},{value:"HTTP Request to OCapistaine (Batch)",id:"http-request-to-ocapistaine-batch",level:3},{value:"Response Format",id:"response-format-3",level:3},{value:"Workflow 5: Issue Webhook Listener",id:"workflow-5-issue-webhook-listener",level:2},{value:"Trigger",id:"trigger-4",level:3},{value:"Flow",id:"flow-4",level:3},{value:"GitHub Webhook Configuration",id:"github-webhook-configuration",level:3},{value:"Workflow 6: Update Issue",id:"workflow-6-update-issue",level:2},{value:"Trigger",id:"trigger-5",level:3},{value:"Input Parameters",id:"input-parameters-4",level:3},{value:"Response Format",id:"response-format-4",level:3},{value:"Workflow 7: List Discussions",id:"workflow-7-list-discussions",level:2},{value:"Trigger",id:"trigger-6",level:3},{value:"Input Parameters",id:"input-parameters-5",level:3},{value:"Flow",id:"flow-5",level:3},{value:"GraphQL Query (built in Python node)",id:"graphql-query-built-in-python-node",level:3},{value:"HTTP Request Configuration",id:"http-request-configuration-1",level:3},{value:"Response Format",id:"response-format-5",level:3},{value:"MCP Tool Definitions",id:"mcp-tool-definitions",level:2},{value:"Labels Schema",id:"labels-schema",level:2},{value:"Validation Outcomes",id:"validation-outcomes",level:3},{value:"Environment Variables (N8N)",id:"environment-variables-n8n",level:2},{value:"Sequence Diagram: Full Validation Flow",id:"sequence-diagram-full-validation-flow",level:2},{value:"Next Steps",id:"next-steps",level:2}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"n8n-github-integration-workflows",children:"N8N GitHub Integration Workflows"})}),"\n",(0,t.jsxs)(n.p,{children:["Design document for N8N workflows managing GitHub issues from ",(0,t.jsx)(n.code,{children:"audierne2026/participons"}),"."]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Important"}),": All N8N Code nodes should use ",(0,t.jsx)(n.strong,{children:"Python"})," for consistency and maintainability.\nSee individual workflow documentation in ",(0,t.jsx)(n.code,{children:"n8n_integrations/"})," for implementation details."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"conventions",children:"Conventions"}),"\n",(0,t.jsx)(n.h3,{id:"code-nodes-python-only",children:"Code Nodes: Python Only"}),"\n",(0,t.jsxs)(n.p,{children:["All transformation and logic code in N8N workflows ",(0,t.jsx)(n.strong,{children:"must be written in Python"})," for:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Consistency with OCapistaine backend (Python)"}),"\n",(0,t.jsx)(n.li,{children:"Easier debugging and testing"}),"\n",(0,t.jsx)(n.li,{children:"Shared utility functions"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"github-api-access",children:"GitHub API Access"}),"\n",(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.strong,{children:"HTTP Request node"})," instead of the GitHub node for listing issues. The GitHub node's ",(0,t.jsx)(n.code,{children:"getAll"})," operation is not available for issues."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"GET https://api.github.com/repos/{owner}/{repo}/issues\nHeaders:\n  Authorization: Bearer {token}\n  Accept: application/vnd.github.v3+json\n"})}),"\n",(0,t.jsx)(n.h3,{id:"workflow-documentation",children:"Workflow Documentation"}),"\n",(0,t.jsxs)(n.p,{children:["Each workflow has detailed documentation in ",(0,t.jsx)(n.code,{children:"n8n_integrations/"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/fr/docs/workflows/n8n_integrations/Participons-List-Issues",children:"Participons - List Issues"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/fr/docs/workflows/n8n_integrations/Participons-List-Discussions",children:"Participons - List Discussions"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/fr/docs/workflows/n8n_integrations/Participons-Get-Discussion",children:"Participons - Get Discussion"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"architecture-overview",children:"Architecture Overview"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         N8N (Vaettir)                                  \u2502\n\u2502                                                                        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502\n\u2502  \u2502 GitHub          \u2502    \u2502 Credential      \u2502    \u2502 MCP Server      \u2502     \u2502\n\u2502  \u2502 Node            \u2502\u25c4\u2500\u2500\u2500\u2502 Store           \u2502    \u2502 /mcp-server/http\u2502     \u2502\n\u2502  \u2502                 \u2502    \u2502 (audierne2026)  \u2502    \u2502                 \u2502     \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502\n\u2502           \u2502                                             \u2502              \u2502\n\u2502           \u25bc                                             \u2502              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\u2502              \u2502\n\u2502  \u2502                    WORKFLOWS                        \u2502\u2502              \u2502\n\u2502  \u2502                                                     \u2502\u2502              \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\u2502              \u2502\n\u2502  \u2502  \u2502 List Issues \u2502  \u2502 Get Issue   \u2502  \u2502 Update     \u2502   \u2502\u2502              \u2502\n\u2502  \u2502  \u2502             \u2502  \u2502 Details     \u2502  \u2502 Issue      \u2502   \u2502\u2502              \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\u2502              \u2502\n\u2502  \u2502                                                     \u2502\u2502              \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\u2502              \u2502\n\u2502  \u2502  \u2502 Validate    \u2502  \u2502 Batch       \u2502  \u2502 Webhook    \u2502   \u2502\u2502              \u2502\n\u2502  \u2502  \u2502 Issue       \u2502  \u2502 Validate    \u2502  \u2502 Listener   \u2502   \u2502\u2502              \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\u2502              \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\u2502              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                          \u2502\n                               MCP Protocol (HTTP + JWT)  \u2502\n                                                          \u25bc\n                                              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                              \u2502   OCapistaine     \u2502\n                                              \u2502   Claude Code     \u2502\n                                              \u2502   Forseti 461     \u2502\n                                              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,t.jsx)(n.h2,{id:"credential-setup-in-n8n",children:"Credential Setup in N8N"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note"}),": GitHub credentials for ",(0,t.jsx)(n.code,{children:"audierne2026/participons"})," will be created directly in N8N by the administrator. They are NOT stored in OCapistaine."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"github-credential-to-be-created-in-n8n",children:"GitHub Credential (to be created in N8N)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Name"}),": ",(0,t.jsx)(n.code,{children:"audierne2026-github"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Type"}),": GitHub OAuth2 or Personal Access Token"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Scopes"}),": ",(0,t.jsx)(n.code,{children:"repo"}),", ",(0,t.jsx)(n.code,{children:"issues:read"}),", ",(0,t.jsx)(n.code,{children:"issues:write"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Repository"}),": ",(0,t.jsx)(n.code,{children:"audierne2026/participons"})]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"forseti461-",children:"Forseti461 :"}),"\n",(0,t.jsx)(n.p,{children:"Personal Access Token : FORSETI_TOKEN\ngithub_username : forseti461"}),"\n",(0,t.jsx)(n.h3,{id:"ocapistaine-api-internal-network",children:"OCapistaine API (internal network)"}),"\n",(0,t.jsx)(n.p,{children:"Personal Access Token : OCAP_TOKEN\ngithub_username : ocapistaine"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Base URL"}),": ",(0,t.jsx)(n.code,{children:"http://localhost:8050"})," (or internal Docker network URL)"]}),"\n",(0,t.jsx)(n.li,{children:"No authentication required for local calls"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"workflow-1-list-participons-issues",children:"Workflow 1: List Participons Issues"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Purpose"}),": Fetch and filter issues from the participons repository."]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Documentation"}),": ",(0,t.jsx)(n.a,{href:"/fr/docs/workflows/n8n_integrations/Participons-List-Issues",children:"n8n_integrations/Participons - List Issues.md"})]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"trigger",children:"Trigger"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Type"}),": Webhook / MCP Tool"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Method"}),": POST"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Path"}),": ",(0,t.jsx)(n.code,{children:"/webhook/participons/issues"})]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"input-parameters",children:"Input Parameters"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "state": "open",\n  "labels": "Task",\n  "per_page": 50\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"flow",children:"Flow"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Webhook  \u2502\u2500\u2500\u2500\u25ba\u2502 HTTP Request \u2502\u2500\u2500\u2500\u25ba\u2502 Python       \u2502\u2500\u2500\u2500\u25ba\u2502 Response \u2502\n\u2502 Trigger  \u2502    \u2502 GitHub API   \u2502    \u2502 Transform    \u2502    \u2502 JSON     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note"}),": Use HTTP Request node instead of GitHub node. The GitHub node's ",(0,t.jsx)(n.code,{children:"getAll"})," operation for issues is not available."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"http-request-configuration",children:"HTTP Request Configuration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Method: GET\nURL: https://api.github.com/repos/audierne2026/participons/issues\n\nQuery Parameters:\n  state: {{ $json.body.state || 'open' }}\n  labels: {{ $json.body.labels || 'Task' }}\n  per_page: {{ $json.body.per_page || 50 }}\n\nHeaders:\n  Authorization: Bearer {{ $credentials.githubApi.accessToken }}\n  Accept: application/vnd.github.v3+json\n  User-Agent: N8N-Forseti461\n"})}),"\n",(0,t.jsx)(n.h3,{id:"output-transformation-python",children:"Output Transformation (Python)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"import re\n\ndef extract_category(issue):\n    \"\"\"Extract category from issue title, body, or labels.\"\"\"\n    title = issue.get('title', '')\n    body = issue.get('body', '') or ''\n    labels = issue.get('labels', [])\n\n    # Check title for [category]\n    title_match = re.search(r'\\[([^\\]]+)\\]', title)\n    if title_match:\n        return title_match.group(1).lower()\n\n    # Check body for Category: xxx\n    body_match = re.search(r'Category:\\s*(\\w+)', body, re.IGNORECASE)\n    if body_match:\n        return body_match.group(1).lower()\n\n    # Check labels\n    category_labels = [\n        'economie', 'logement', 'culture', 'ecologie',\n        'associations', 'jeunesse', 'alimentation-bien-etre-soins'\n    ]\n    for label in labels:\n        label_name = label.get('name', '') if isinstance(label, dict) else str(label)\n        if label_name.lower() in category_labels:\n            return label_name.lower()\n\n    return None\n\n\ndef transform_issues(items):\n    \"\"\"Transform GitHub API response to standardized format.\"\"\"\n    issues = []\n    for item in items:\n        issue = item if isinstance(item, dict) else item.get('json', {})\n        labels = issue.get('labels', [])\n        label_names = [l.get('name') if isinstance(l, dict) else str(l) for l in labels]\n\n        issues.append({\n            'id': issue.get('number'),\n            'title': issue.get('title'),\n            'body': issue.get('body') or '',\n            'state': issue.get('state'),\n            'labels': label_names,\n            'category': extract_category(issue),\n            'created_at': issue.get('created_at'),\n            'updated_at': issue.get('updated_at'),\n            'html_url': issue.get('html_url'),\n            'user': issue.get('user', {}).get('login', 'unknown'),\n            'has_conforme_charte': 'conforme charte' in [l.lower() for l in label_names]\n        })\n\n    return {'success': True, 'count': len(issues), 'issues': issues}\n\n\n# N8N entry point\nitems = $input.all()\ngithub_issues = items[0]['json'] if items and isinstance(items[0].get('json'), list) else [i.get('json', i) for i in items]\nreturn [{'json': transform_issues(github_issues)}]\n"})}),"\n",(0,t.jsx)(n.h3,{id:"response-format",children:"Response Format"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "count": 15,\n  "issues": [\n    {\n      "id": 42,\n      "title": "[economie] Am\xe9lioration du port",\n      "body": "Proposition pour moderniser...",\n      "state": "open",\n      "labels": ["Task", "economie"],\n      "category": "economie",\n      "created_at": "2024-01-15T10:30:00Z",\n      "html_url": "https://github.com/audierne2026/participons/issues/42",\n      "user": "citizen123"\n    }\n  ]\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"workflow-2-get-issue-details",children:"Workflow 2: Get Issue Details"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Purpose"}),": Fetch a single issue with full details and comments."]}),"\n",(0,t.jsx)(n.h3,{id:"trigger-1",children:"Trigger"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Type"}),": Webhook / MCP Tool"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Method"}),": GET"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Path"}),": ",(0,t.jsx)(n.code,{children:"/webhook/participons/issues/:number"})]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"input-parameters-1",children:"Input Parameters"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "number": 42, // Issue number (required)\n  "include_comments": true // Whether to fetch comments\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"flow-1",children:"Flow"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Webhook  \u2502\u2500\u2500\u2500\u25ba\u2502 GitHub Node  \u2502\u2500\u2500\u2500\u25ba\u2502 GitHub Node  \u2502\u2500\u2500\u2500\u25ba\u2502 Merge &  \u2502\n\u2502 Trigger  \u2502    \u2502 Get Issue    \u2502    \u2502 Get Comments \u2502    \u2502 Response \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                           \u2502\n                                    (if include_comments)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"response-format-1",children:"Response Format"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "issue": {\n    "id": 42,\n    "title": "[economie] Am\xe9lioration du port",\n    "body": "Proposition d\xe9taill\xe9e...",\n    "state": "open",\n    "labels": ["Task", "economie"],\n    "category": "economie",\n    "created_at": "2024-01-15T10:30:00Z",\n    "updated_at": "2024-01-16T14:20:00Z",\n    "html_url": "https://github.com/audierne2026/participons/issues/42",\n    "user": "citizen123",\n    "comments_count": 3,\n    "comments": [\n      {\n        "id": 123,\n        "body": "Bonne id\xe9e !",\n        "user": "autre_citoyen",\n        "created_at": "2024-01-15T12:00:00Z"\n      }\n    ]\n  }\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"workflow-3-validate-issue-via-ocapistaine",children:"Workflow 3: Validate Issue (via OCapistaine)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Purpose"}),": Send an issue to Forseti 461 for charter validation."]}),"\n",(0,t.jsx)(n.h3,{id:"trigger-2",children:"Trigger"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Type"}),": Webhook / MCP Tool"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Method"}),": POST"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Path"}),": ",(0,t.jsx)(n.code,{children:"/webhook/participons/validate"})]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"input-parameters-2",children:"Input Parameters"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "number": 42, // Issue number to validate\n  "auto_label": true, // Automatically add validation labels\n  "auto_comment": false // Post validation result as comment\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"flow-2",children:"Flow"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Webhook  \u2502\u2500\u2500\u2500\u25ba\u2502 GitHub Node  \u2502\u2500\u2500\u2500\u25ba\u2502 HTTP Request \u2502\u2500\u2500\u2500\u25ba\u2502 IF Valid?    \u2502\n\u2502 Trigger  \u2502    \u2502 Get Issue    \u2502    \u2502 POST to      \u2502    \u2502              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502 /api/v1/     \u2502    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                    \u2502 validate     \u2502           \u2502\n                                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n                    \u2502 YES                                      \u2502 NO\n                    \u25bc                                          \u25bc\n           \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                           \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n           \u2502 Add Label    \u2502                           \u2502 No label     \u2502\n           \u2502 "conforme    \u2502                           \u2502 change       \u2502\n           \u2502  charte"     \u2502                           \u2502 (Opik logs)  \u2502\n           \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                           \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                    \u2502                                          \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                       \u25bc\n                              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                              \u2502 Response     \u2502\n                              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note"}),": All validation results (valid or invalid) are automatically traced to Opik by OCapistaine. Violations are visible in the Opik dashboard, not on GitHub."]}),"\n",(0,t.jsx)(n.h3,{id:"http-request-to-ocapistaine",children:"HTTP Request to OCapistaine"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'POST http://localhost:8050/api/v1/validate\nContent-Type: application/json\n\n{\n  "title": "{{ $json.issue.title }}",\n  "body": "{{ $json.issue.body }}",\n  "category": "{{ $json.issue.category }}"\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"label-logic-python",children:"Label Logic (Python)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# Code node after validation\nresult = $input.first().json\n\n# Simple logic: only add \"conforme charte\" if valid\n# Violations are tracked in Opik, not via GitHub labels\nlabels_to_add = ['conforme charte'] if result.get('is_valid') else []\n\nreturn [{\n    'json': {\n        'issue_number': $node['Get Issue'].json.get('number'),\n        'labels_to_add': labels_to_add,\n        'is_valid': result.get('is_valid'),\n        'validation_result': result\n        # Note: violations logged to Opik automatically by OCapistaine\n    }\n}]\n"})}),"\n",(0,t.jsx)(n.h3,{id:"response-format-2",children:"Response Format"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "issue_number": 42,\n  "validation": {\n    "is_valid": true,\n    "category": "economie",\n    "original_category": "economie",\n    "violations": [],\n    "encouraged_aspects": ["Concrete proposal", "Constructive"],\n    "confidence": 0.92\n  },\n  "actions_taken": {\n    "labels_added": ["conforme charte"],\n    "opik_trace_id": "abc123"\n  }\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"workflow-4-batch-validate-issues",children:"Workflow 4: Batch Validate Issues"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Purpose"}),": Validate all open Task issues in batch."]}),"\n",(0,t.jsx)(n.h3,{id:"trigger-3",children:"Trigger"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Type"}),": Webhook / MCP Tool / Schedule"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Method"}),": POST"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Path"}),": ",(0,t.jsx)(n.code,{children:"/webhook/participons/validate-batch"})]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"input-parameters-3",children:"Input Parameters"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "state": "open",\n  "labels": ["Task"],\n  "exclude_validated": true, // Skip already validated issues\n  "limit": 20, // Max issues to process\n  "dry_run": false // If true, don\'t update GitHub\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"flow-3",children:"Flow"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Webhook  \u2502\u2500\u2500\u2500\u25ba\u2502 List Issues  \u2502\u2500\u2500\u2500\u25ba\u2502 Filter       \u2502\u2500\u2500\u2500\u25ba\u2502 HTTP Request \u2502\n\u2502 Trigger  \u2502    \u2502 (Workflow 1) \u2502    \u2502 Unvalidated  \u2502    \u2502 POST /batch  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                               \u2502\n                                                               \u25bc\n                                                        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                                        \u2502 Loop: Update \u2502\n                                                        \u2502 Each Issue   \u2502\n                                                        \u2502 Labels       \u2502\n                                                        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                               \u2502\n                                                               \u25bc\n                                                        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                                        \u2502 Summary      \u2502\n                                                        \u2502 Response     \u2502\n                                                        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,t.jsx)(n.h3,{id:"http-request-to-ocapistaine-batch",children:"HTTP Request to OCapistaine (Batch)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'POST http://localhost:8050/api/v1/validate/batch\nContent-Type: application/json\n\n{\n  "items": [\n    {"id": "42", "title": "...", "body": "...", "category": "..."},\n    {"id": "43", "title": "...", "body": "...", "category": "..."}\n  ]\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"response-format-3",children:"Response Format"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "summary": {\n    "total_processed": 15,\n    "valid": 12,\n    "invalid": 3,\n    "category_corrections": 2\n  },\n  "results": [\n    {\n      "issue_number": 42,\n      "is_valid": true,\n      "category": "economie",\n      "label_added": "conforme charte"\n    },\n    {\n      "issue_number": 43,\n      "is_valid": false,\n      "category": "logement",\n      "label_added": null,\n      "violations_logged_to_opik": true\n    }\n  ],\n  "dry_run": false\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"workflow-5-issue-webhook-listener",children:"Workflow 5: Issue Webhook Listener"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Purpose"}),": Automatically validate new issues when created."]}),"\n",(0,t.jsx)(n.h3,{id:"trigger-4",children:"Trigger"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Type"}),": GitHub Webhook"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Events"}),": ",(0,t.jsx)(n.code,{children:"issues.opened"}),", ",(0,t.jsx)(n.code,{children:"issues.edited"})]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"flow-4",children:"Flow"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 GitHub       \u2502\u2500\u2500\u2500\u25ba\u2502 Filter:      \u2502\u2500\u2500\u2500\u25ba\u2502 Validate     \u2502\u2500\u2500\u2500\u25ba\u2502 Update Issue \u2502\n\u2502 Webhook      \u2502    \u2502 Has [Task]   \u2502    \u2502 (Workflow 3) \u2502    \u2502 Labels       \u2502\n\u2502 issues.opened\u2502    \u2502 label?       \u2502    \u2502              \u2502    \u2502              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,t.jsx)(n.h3,{id:"github-webhook-configuration",children:"GitHub Webhook Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["In ",(0,t.jsx)(n.code,{children:"audierne2026/participons"})," repository settings:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Payload URL"}),": ",(0,t.jsx)(n.code,{children:"https://vaettir.locki.io/webhook/participons/new-issue"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Content type"}),": ",(0,t.jsx)(n.code,{children:"application/json"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Events"}),": Issues (opened, edited)"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"workflow-6-update-issue",children:"Workflow 6: Update Issue"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Purpose"}),": Update issue labels, add comments, or close issues."]}),"\n",(0,t.jsx)(n.h3,{id:"trigger-5",children:"Trigger"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Type"}),": Webhook / MCP Tool"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Method"}),": PATCH"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Path"}),": ",(0,t.jsx)(n.code,{children:"/webhook/participons/issues/:number"})]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"input-parameters-4",children:"Input Parameters"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "number": 42,\n  "add_labels": ["conforme charte"],\n  "remove_labels": [],\n  "add_comment": null,\n  "state": null // "open" | "closed" | null (no change)\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"response-format-4",children:"Response Format"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "issue_number": 42,\n  "changes": {\n    "labels_added": ["conforme charte"],\n    "labels_removed": [],\n    "state": "open"\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note"}),": Only use existing labels. Do not create new labels via this workflow."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"workflow-7-list-discussions",children:"Workflow 7: List Discussions"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Purpose"}),": Fetch discussions from the participons repository using GitHub's GraphQL API."]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Documentation"}),": ",(0,t.jsx)(n.a,{href:"/fr/docs/workflows/n8n_integrations/Participons-List-Discussions",children:"n8n_integrations/Participons - List Discussions.md"})]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"trigger-6",children:"Trigger"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Type"}),": Webhook / MCP Tool"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Method"}),": POST"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Path"}),": ",(0,t.jsx)(n.code,{children:"/webhook/participons/discussions"})]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"input-parameters-5",children:"Input Parameters"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "per_page": 10, // Number of discussions (default: 10, max: 100)\n  "category_slug": null, // Filter by category (e.g., "ideas", "announcements")\n  "after": null // Pagination cursor\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"flow-5",children:"Flow"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Webhook  \u2502\u2500\u2500\u2500\u25ba\u2502 Python Build \u2502\u2500\u2500\u2500\u25ba\u2502 HTTP Request \u2502\u2500\u2500\u2500\u25ba\u2502 Python       \u2502\n\u2502 Trigger  \u2502    \u2502 GraphQL      \u2502    \u2502 GraphQL API  \u2502    \u2502 Transform    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                                \u2502\n                                                                \u25bc\n                                                         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                                         \u2502 Response     \u2502\n                                                         \u2502 JSON         \u2502\n                                                         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,t.jsx)(n.h3,{id:"graphql-query-built-in-python-node",children:"GraphQL Query (built in Python node)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'def build_discussions_query(owner, repo, first=10, category=None, after=None):\n    """Build GraphQL query for fetching discussions."""\n    category_filter = f\', categoryId: "{category}"\' if category else ""\n    after_clause = f\', after: "{after}"\' if after else ""\n\n    query = f"""\n    query {{\n      repository(owner: "{owner}", name: "{repo}") {{\n        discussions(first: {first}{category_filter}{after_clause},\n                   orderBy: {{field: UPDATED_AT, direction: DESC}}) {{\n          totalCount\n          pageInfo {{ hasNextPage endCursor }}\n          nodes {{\n            id number title body url createdAt updatedAt\n            author {{ login }}\n            category {{ id name slug }}\n            labels(first: 10) {{ nodes {{ name }} }}\n            comments(first: 1) {{ totalCount }}\n            upvoteCount isAnswered answerChosenAt\n          }}\n        }}\n        discussionCategories(first: 10) {{\n          nodes {{ id name slug description }}\n        }}\n      }}\n    }}\n    """\n    return query\n'})}),"\n",(0,t.jsx)(n.h3,{id:"http-request-configuration-1",children:"HTTP Request Configuration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'Method: POST\nURL: https://api.github.com/graphql\n\nHeaders:\n  Authorization: Bearer {{ $credentials.githubApi.accessToken }}\n  Content-Type: application/json\n  User-Agent: N8N-Forseti461\n\nBody:\n  { "query": "{{ $json.query }}" }\n'})}),"\n",(0,t.jsx)(n.h3,{id:"response-format-5",children:"Response Format"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "count": 10,\n  "total_count": 45,\n  "has_next_page": true,\n  "end_cursor": "Y3Vyc29yOnYyOpK5MjAyNC0wMS0xNVQxMDozMDowMFo=",\n  "discussions": [\n    {\n      "id": 5,\n      "title": "Proposition pour am\xe9liorer le port d\'Audierne",\n      "body": "Je propose de moderniser...",\n      "url": "https://github.com/audierne2026/participons/discussions/5",\n      "created_at": "2024-01-15T10:30:00Z",\n      "updated_at": "2024-01-20T14:20:00Z",\n      "author": "citizen123",\n      "category": {\n        "id": "DIC_kwDOJxyz1M4CZabc",\n        "name": "Ideas",\n        "slug": "ideas"\n      },\n      "labels": ["economie", "infrastructure"],\n      "comments_count": 12,\n      "upvotes": 8,\n      "is_answered": false\n    }\n  ],\n  "available_categories": [\n    {\n      "id": "DIC_kwDOJxyz1M4CZabc",\n      "name": "Ideas",\n      "slug": "ideas",\n      "description": "Share ideas for new features"\n    }\n  ]\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note"}),": GitHub Discussions use GraphQL API (v4), not REST API. Category filtering requires GraphQL IDs, which are provided in the response's ",(0,t.jsx)(n.code,{children:"available_categories"})," field."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"mcp-tool-definitions",children:"MCP Tool Definitions"}),"\n",(0,t.jsx)(n.p,{children:"When exposed via N8N's MCP Server, these workflows become tools:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "tools": [\n    {\n      "name": "participons_list_issues",\n      "description": "List issues from audierne2026/participons repository",\n      "inputSchema": {\n        "type": "object",\n        "properties": {\n          "state": { "type": "string", "enum": ["open", "closed", "all"] },\n          "labels": { "type": "array", "items": { "type": "string" } },\n          "category": { "type": "string" },\n          "per_page": { "type": "integer", "default": 50 }\n        }\n      }\n    },\n    {\n      "name": "participons_get_issue",\n      "description": "Get details of a specific issue",\n      "inputSchema": {\n        "type": "object",\n        "properties": {\n          "number": { "type": "integer" },\n          "include_comments": { "type": "boolean", "default": false }\n        },\n        "required": ["number"]\n      }\n    },\n    {\n      "name": "participons_validate_issue",\n      "description": "Validate an issue against the contribution charter using Forseti 461",\n      "inputSchema": {\n        "type": "object",\n        "properties": {\n          "number": { "type": "integer" },\n          "auto_label": { "type": "boolean", "default": true }\n        },\n        "required": ["number"]\n      }\n    },\n    {\n      "name": "participons_validate_batch",\n      "description": "Validate all pending issues in batch",\n      "inputSchema": {\n        "type": "object",\n        "properties": {\n          "limit": { "type": "integer", "default": 20 },\n          "dry_run": { "type": "boolean", "default": false }\n        }\n      }\n    },\n    {\n      "name": "participons_list_discussions",\n      "description": "List discussions from audierne2026/participons repository using GraphQL API",\n      "inputSchema": {\n        "type": "object",\n        "properties": {\n          "per_page": { "type": "integer", "default": 10, "maximum": 100 },\n          "category_slug": {\n            "type": "string",\n            "enum": ["ideas", "announcements", "q-and-a", "general"],\n            "description": "Filter by discussion category slug"\n          },\n          "after": {\n            "type": "string",\n            "description": "Pagination cursor for next page (from previous response\'s end_cursor)"\n          }\n        }\n      }\n    },\n    {\n      "name": "participons_get_discussion",\n      "description": "Get details of a specific discussion including all comments",\n      "inputSchema": {\n        "type": "object",\n        "properties": {\n          "number": { "type": "integer" },\n          "include_comments": { "type": "boolean", "default": true }\n        },\n        "required": ["number"]\n      }\n    }\n  ]\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"labels-schema",children:"Labels Schema"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Important"}),": Do NOT create new labels. Use only existing labels in ",(0,t.jsx)(n.code,{children:"audierne2026/participons"}),"."]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Label"}),(0,t.jsx)(n.th,{children:"Action"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Task"})}),(0,t.jsx)(n.td,{children:"Read only"}),(0,t.jsx)(n.td,{children:"Identifies citizen contributions"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"conforme charte"})}),(0,t.jsx)(n.td,{children:"Add if valid"}),(0,t.jsx)(n.td,{children:"Issue passed charter validation"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"validation-outcomes",children:"Validation Outcomes"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Outcome"}),(0,t.jsx)(n.th,{children:"Label Action"}),(0,t.jsx)(n.th,{children:"Tracking"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Valid"})}),(0,t.jsxs)(n.td,{children:["Add ",(0,t.jsx)(n.code,{children:"conforme charte"})]}),(0,t.jsx)(n.td,{children:"Logged in Opik"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Invalid"})}),(0,t.jsx)(n.td,{children:"No label change"}),(0,t.jsx)(n.td,{children:"Violations logged in Opik dashboard"})]})]})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note"}),": Violations are NOT tracked via GitHub labels. All violation details (type, reasoning, confidence) are recorded in Opik for analysis and auditing. This keeps the GitHub interface clean while maintaining full traceability."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"environment-variables-n8n",children:"Environment Variables (N8N)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# OCapistaine API\nOCAPISTAINE_API_URL=http://localhost:8050\nOCAPISTAINE_API_KEY=optional_api_key\n\n# GitHub (stored in N8N credential store, not env)\n# GITHUB_PAT=... (use credential node instead)\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"sequence-diagram-full-validation-flow",children:"Sequence Diagram: Full Validation Flow"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Claude  \u2502     \u2502  N8N    \u2502     \u2502 OCapistaine \u2502      \u2502  GitHub  \u2502\n\u2502  Code   \u2502     \u2502 Vaettir \u2502     \u2502 Forseti 461 \u2502      \u2502   API    \u2502\n\u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n     \u2502               \u2502                 \u2502                  \u2502\n     \u2502 MCP: list_issues                \u2502                  \u2502\n     \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502                 \u2502                  \u2502\n     \u2502               \u2502 GET /issues     \u2502                  \u2502\n     \u2502               \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\n     \u2502               \u2502                 \u2502     issues[]     \u2502\n     \u2502               \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n     \u2502  issues[]     \u2502                 \u2502                  \u2502\n     \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                 \u2502                  \u2502\n     \u2502               \u2502                 \u2502                  \u2502\n     \u2502 MCP: validate_issue(42)         \u2502                  \u2502\n     \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502                 \u2502                  \u2502\n     \u2502               \u2502 GET /issues/42  \u2502                  \u2502\n     \u2502               \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\n     \u2502               \u2502                 \u2502      issue       \u2502\n     \u2502               \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n     \u2502               \u2502                 \u2502                  \u2502\n     \u2502               \u2502 POST /validate  \u2502                  \u2502\n     \u2502               \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502                  \u2502\n     \u2502               \u2502                 \u2502 (Forseti 461)    \u2502\n     \u2502               \u2502  validation     \u2502                  \u2502\n     \u2502               \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                  \u2502\n     \u2502               \u2502                 \u2502                  \u2502\n     \u2502               \u2502 PATCH /issues/42/labels            \u2502\n     \u2502               \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\n     \u2502               \u2502                 \u2502      ok          \u2502\n     \u2502               \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n     \u2502  result       \u2502                 \u2502                  \u2502\n     \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                 \u2502                  \u2502\n     \u2502               \u2502                 \u2502                  \u2502\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Create GitHub credential"})," in N8N with audierne2026 PAT"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Import workflow templates"})," (can be exported as JSON)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Configure MCP server"})," to expose workflows as tools"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Test with Claude Code"})," using the MCP endpoint"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Set up GitHub webhook"})," for automatic validation"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453(e,n,s){s.d(n,{R:()=>o,x:()=>l});var i=s(6540);const t={},r=i.createContext(t);function o(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);